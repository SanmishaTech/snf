import{r as g,U as Ce,j as e,V as Se,W as Pe,X as O,Y as Q,Z as K,_ as Re,$ as le,a0 as ke,a1 as De,a2 as Y,d as Me,e as Ae,f as Ee,a3 as W,A as _,B as D,i as $e,z as I,a4 as Le,I as X,a5 as G,a6 as q,a7 as Z,a8 as J,a9 as oe,aa as V,a as Fe,F as Te,ab as _e,ac as Be,ad as Ie,ae as ze,af as Ve,ag as Oe,ah as Ke,ai as ie}from"./index-C5oU3O64.js";import{u as He,H as Qe,F as Ue,p as Ye,P as Xe,C as Ge}from"./Footer-DGDJ2ym9.js";import{P as qe}from"./ProductGrid-C1KtjqRB.js";import{a as Ze}from"./useProducts-Lap-qmTl.js";import"./ProductCard-BOAzKux8.js";var de=["PageUp","PageDown"],ue=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],me={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},H="Slider",[ee,Je,We]=Pe(H),[he,Ra]=Se(H,[We]),[ea,U]=he(H),ge=g.forwardRef((s,t)=>{const{name:a,min:r=0,max:n=100,step:h=1,orientation:d="horizontal",disabled:u=!1,minStepsBetweenThumbs:v=0,defaultValue:w=[r],value:S,onValueChange:c=()=>{},onValueCommit:y=()=>{},inverted:i=!1,form:f,...b}=s,j=g.useRef(new Set),C=g.useRef(0),k=d==="horizontal"?aa:sa,[o=[],l]=Ce({prop:S,defaultProp:w,onChange:x=>{var p;(p=[...j.current][C.current])==null||p.focus(),c(x)}}),m=g.useRef(o);function N(x){const P=ia(o,x);A(x,P)}function M(x){A(x,C.current)}function L(){const x=m.current[C.current];o[C.current]!==x&&y(o)}function A(x,P,{commit:p}={commit:!1}){const E=ua(h),F=ma(Math.round((x-r)/h)*h+r,E),B=le(F,[r,n]);l((T=[])=>{const R=na(T,B,P);if(da(R,v*h)){C.current=R.indexOf(B);const z=String(R)!==String(T);return z&&p&&y(R),z?R:T}else return T})}return e.jsx(ea,{scope:s.__scopeSlider,name:a,disabled:u,min:r,max:n,valueIndexToChangeRef:C,thumbs:j.current,values:o,orientation:d,form:f,children:e.jsx(ee.Provider,{scope:s.__scopeSlider,children:e.jsx(ee.Slot,{scope:s.__scopeSlider,children:e.jsx(k,{"aria-disabled":u,"data-disabled":u?"":void 0,...b,ref:t,onPointerDown:O(b.onPointerDown,()=>{u||(m.current=o)}),min:r,max:n,inverted:i,onSlideStart:u?void 0:N,onSlideMove:u?void 0:M,onSlideEnd:u?void 0:L,onHomeKeyDown:()=>!u&&A(r,0,{commit:!0}),onEndKeyDown:()=>!u&&A(n,o.length-1,{commit:!0}),onStepKeyDown:({event:x,direction:P})=>{if(!u){const F=de.includes(x.key)||x.shiftKey&&ue.includes(x.key)?10:1,B=C.current,T=o[B],R=h*F*P;A(T+R,B,{commit:!0})}}})})})})});ge.displayName=H;var[fe,xe]=he(H,{startEdge:"left",endEdge:"right",size:"width",direction:1}),aa=g.forwardRef((s,t)=>{const{min:a,max:r,dir:n,inverted:h,onSlideStart:d,onSlideMove:u,onSlideEnd:v,onStepKeyDown:w,...S}=s,[c,y]=g.useState(null),i=K(t,k=>y(k)),f=g.useRef(void 0),b=Re(n),j=b==="ltr",C=j&&!h||!j&&h;function $(k){const o=f.current||c.getBoundingClientRect(),l=[0,o.width],N=te(l,C?[a,r]:[r,a]);return f.current=o,N(k-o.left)}return e.jsx(fe,{scope:s.__scopeSlider,startEdge:C?"left":"right",endEdge:C?"right":"left",direction:C?1:-1,size:"width",children:e.jsx(pe,{dir:b,"data-orientation":"horizontal",...S,ref:i,style:{...S.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:k=>{const o=$(k.clientX);d==null||d(o)},onSlideMove:k=>{const o=$(k.clientX);u==null||u(o)},onSlideEnd:()=>{f.current=void 0,v==null||v()},onStepKeyDown:k=>{const l=me[C?"from-left":"from-right"].includes(k.key);w==null||w({event:k,direction:l?-1:1})}})})}),sa=g.forwardRef((s,t)=>{const{min:a,max:r,inverted:n,onSlideStart:h,onSlideMove:d,onSlideEnd:u,onStepKeyDown:v,...w}=s,S=g.useRef(null),c=K(t,S),y=g.useRef(void 0),i=!n;function f(b){const j=y.current||S.current.getBoundingClientRect(),C=[0,j.height],k=te(C,i?[r,a]:[a,r]);return y.current=j,k(b-j.top)}return e.jsx(fe,{scope:s.__scopeSlider,startEdge:i?"bottom":"top",endEdge:i?"top":"bottom",size:"height",direction:i?1:-1,children:e.jsx(pe,{"data-orientation":"vertical",...w,ref:c,style:{...w.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const j=f(b.clientY);h==null||h(j)},onSlideMove:b=>{const j=f(b.clientY);d==null||d(j)},onSlideEnd:()=>{y.current=void 0,u==null||u()},onStepKeyDown:b=>{const C=me[i?"from-bottom":"from-top"].includes(b.key);v==null||v({event:b,direction:C?-1:1})}})})}),pe=g.forwardRef((s,t)=>{const{__scopeSlider:a,onSlideStart:r,onSlideMove:n,onSlideEnd:h,onHomeKeyDown:d,onEndKeyDown:u,onStepKeyDown:v,...w}=s,S=U(H,a);return e.jsx(Q.span,{...w,ref:t,onKeyDown:O(s.onKeyDown,c=>{c.key==="Home"?(d(c),c.preventDefault()):c.key==="End"?(u(c),c.preventDefault()):de.concat(ue).includes(c.key)&&(v(c),c.preventDefault())}),onPointerDown:O(s.onPointerDown,c=>{const y=c.target;y.setPointerCapture(c.pointerId),c.preventDefault(),S.thumbs.has(y)?y.focus():r(c)}),onPointerMove:O(s.onPointerMove,c=>{c.target.hasPointerCapture(c.pointerId)&&n(c)}),onPointerUp:O(s.onPointerUp,c=>{const y=c.target;y.hasPointerCapture(c.pointerId)&&(y.releasePointerCapture(c.pointerId),h(c))})})}),be="SliderTrack",ve=g.forwardRef((s,t)=>{const{__scopeSlider:a,...r}=s,n=U(be,a);return e.jsx(Q.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...r,ref:t})});ve.displayName=be;var ae="SliderRange",ye=g.forwardRef((s,t)=>{const{__scopeSlider:a,...r}=s,n=U(ae,a),h=xe(ae,a),d=g.useRef(null),u=K(t,d),v=n.values.length,w=n.values.map(y=>Ne(y,n.min,n.max)),S=v>1?Math.min(...w):0,c=100-Math.max(...w);return e.jsx(Q.span,{"data-orientation":n.orientation,"data-disabled":n.disabled?"":void 0,...r,ref:u,style:{...s.style,[h.startEdge]:S+"%",[h.endEdge]:c+"%"}})});ye.displayName=ae;var se="SliderThumb",je=g.forwardRef((s,t)=>{const a=Je(s.__scopeSlider),[r,n]=g.useState(null),h=K(t,u=>n(u)),d=g.useMemo(()=>r?a().findIndex(u=>u.ref.current===r):-1,[a,r]);return e.jsx(ta,{...s,ref:h,index:d})}),ta=g.forwardRef((s,t)=>{const{__scopeSlider:a,index:r,name:n,...h}=s,d=U(se,a),u=xe(se,a),[v,w]=g.useState(null),S=K(t,$=>w($)),c=v?d.form||!!v.closest("form"):!0,y=ke(v),i=d.values[r],f=i===void 0?0:Ne(i,d.min,d.max),b=oa(r,d.values.length),j=y==null?void 0:y[u.size],C=j?ca(j,f,u.direction):0;return g.useEffect(()=>{if(v)return d.thumbs.add(v),()=>{d.thumbs.delete(v)}},[v,d.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[u.startEdge]:`calc(${f}% + ${C}px)`},children:[e.jsx(ee.ItemSlot,{scope:s.__scopeSlider,children:e.jsx(Q.span,{role:"slider","aria-label":s["aria-label"]||b,"aria-valuemin":d.min,"aria-valuenow":i,"aria-valuemax":d.max,"aria-orientation":d.orientation,"data-orientation":d.orientation,"data-disabled":d.disabled?"":void 0,tabIndex:d.disabled?void 0:0,...h,ref:S,style:i===void 0?{display:"none"}:s.style,onFocus:O(s.onFocus,()=>{d.valueIndexToChangeRef.current=r})})}),c&&e.jsx(we,{name:n??(d.name?d.name+(d.values.length>1?"[]":""):void 0),form:d.form,value:i},r)]})});je.displayName=se;var ra="RadioBubbleInput",we=g.forwardRef(({__scopeSlider:s,value:t,...a},r)=>{const n=g.useRef(null),h=K(n,r),d=De(t);return g.useEffect(()=>{const u=n.current;if(!u)return;const v=window.HTMLInputElement.prototype,S=Object.getOwnPropertyDescriptor(v,"value").set;if(d!==t&&S){const c=new Event("input",{bubbles:!0});S.call(u,t),u.dispatchEvent(c)}},[d,t]),e.jsx(Q.input,{style:{display:"none"},...a,ref:h,defaultValue:t})});we.displayName=ra;function na(s=[],t,a){const r=[...s];return r[a]=t,r.sort((n,h)=>n-h)}function Ne(s,t,a){const h=100/(a-t)*(s-t);return le(h,[0,100])}function oa(s,t){return t>2?`Value ${s+1} of ${t}`:t===2?["Minimum","Maximum"][s]:void 0}function ia(s,t){if(s.length===1)return 0;const a=s.map(n=>Math.abs(n-t)),r=Math.min(...a);return a.indexOf(r)}function ca(s,t,a){const r=s/2,h=te([0,50],[0,r]);return(r-h(t)*a)*a}function la(s){return s.slice(0,-1).map((t,a)=>s[a+1]-t)}function da(s,t){if(t>0){const a=la(s);return Math.min(...a)>=t}return!0}function te(s,t){return a=>{if(s[0]===s[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(s[1]-s[0]);return t[0]+r*(a-s[0])}}function ua(s){return(String(s).split(".")[1]||"").length}function ma(s,t){const a=Math.pow(10,t);return Math.round(s*a)/a}var ha=ge,ga=ve,fa=ye,xa=je;function pa({className:s,defaultValue:t,value:a,min:r=0,max:n=100,...h}){const d=g.useMemo(()=>Array.isArray(a)?a:Array.isArray(t)?t:[r,n],[a,t,r,n]);return e.jsxs(ha,{"data-slot":"slider",defaultValue:t,value:a,min:r,max:n,className:Y("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",s),...h,children:[e.jsx(ga,{"data-slot":"slider-track",className:Y("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(fa,{"data-slot":"slider-range",className:Y("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:d.length},(u,v)=>e.jsx(xa,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},v))]})}const ba=["Fruits & Vegetables","Dairy & Eggs","Meat & Seafood","Bakery","Beverages","Snacks","Frozen Foods","Personal Care","Household","Baby Care"],va=["Amul","Britannia","Nestle","ITC","Parle","Haldiram's","MTR","Organic India","24 Mantra","Fresho"];function ce({filters:s,onFiltersChange:t,onClearAll:a,categories:r,brands:n}){const h=(r==null?void 0:r.map(i=>i.name))||ba,d=n||va,[u,v]=g.useState({categories:!0,brands:!0,price:!0,rating:!0,discount:!1,availability:!1}),w=i=>{v(f=>({...f,[i]:!f[i]}))},S=(i,f)=>{const b=f?[...s.categories,i]:s.categories.filter(j=>j!==i);t({...s,categories:b})},c=(i,f)=>{const b=f?[...s.brands,i]:s.brands.filter(j=>j!==i);t({...s,brands:b})},y=s.categories.length+s.brands.length+s.availability.length+(s.rating>0?1:0)+(s.discount>0?1:0)+(s.priceRange[0]>0||s.priceRange[1]<1e4?1:0);return e.jsxs(Me,{className:"w-full max-w-sm",children:[e.jsx(Ae,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ee,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),"Filters",y>0&&e.jsx(_,{variant:"secondary",className:"ml-2",children:y})]}),y>0&&e.jsx(D,{variant:"ghost",size:"sm",onClick:a,children:"Clear All"})]})}),e.jsxs($e,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{htmlFor:"search",children:"Search Products"}),e.jsxs("div",{className:"relative",children:[e.jsx(Le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(X,{id:"search",placeholder:"Search for products...",value:s.searchQuery,onChange:i=>t({...s,searchQuery:i.target.value}),className:"pl-10"})]})]}),e.jsxs(G,{open:u.categories,onOpenChange:()=>w("categories"),children:[e.jsxs(q,{className:"flex w-full items-center justify-between py-2",children:[e.jsx(I,{className:"text-sm font-medium",children:"Categories"}),e.jsx(Z,{className:`h-4 w-4 transition-transform ${u.categories?"rotate-180":""}`})]}),e.jsx(J,{className:"space-y-3 pt-2",children:e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:h.map(i=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{id:`category-${i}`,checked:s.categories.includes(i),onCheckedChange:f=>S(i,f),className:"h-4 w-4 md:h-5 md:w-5"}),e.jsx(I,{htmlFor:`category-${i}`,className:"text-sm font-normal",children:i})]},i))})})]}),e.jsxs(G,{open:u.price,onOpenChange:()=>w("price"),children:[e.jsxs(q,{className:"flex w-full items-center justify-between py-2",children:[e.jsx(I,{className:"text-sm font-medium",children:"Price Range"}),e.jsx(Z,{className:`h-4 w-4 transition-transform ${u.price?"rotate-180":""}`})]}),e.jsx(J,{className:"space-y-4 pt-2",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(I,{htmlFor:"min-price",className:"text-xs text-muted-foreground",children:"Min"}),e.jsx(X,{id:"min-price",type:"number",placeholder:"0",value:s.priceRange[0]||"",onChange:i=>{const f=Math.max(0,parseInt(i.target.value)||0),b=Math.max(f,s.priceRange[1]);t({...s,priceRange:[f,b]})},className:"h-8 text-sm"})]}),e.jsx("span",{className:"text-muted-foreground mt-4",children:"-"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(I,{htmlFor:"max-price",className:"text-xs text-muted-foreground",children:"Max"}),e.jsx(X,{id:"max-price",type:"number",placeholder:"10000",value:s.priceRange[1]||"",onChange:i=>{const f=Math.min(1e4,parseInt(i.target.value)||1e4),b=Math.min(f,s.priceRange[0]);t({...s,priceRange:[b,f]})},className:"h-8 text-sm"})]})]}),e.jsxs("div",{className:"px-2",children:[e.jsx(pa,{value:s.priceRange,onValueChange:i=>t({...s,priceRange:i}),max:1e4,min:0,step:50,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground mt-2",children:[e.jsxs("span",{children:["₹",s.priceRange[0]]}),e.jsxs("span",{children:["₹",s.priceRange[1]]})]})]})]})})]}),e.jsxs(G,{open:u.brands,onOpenChange:()=>w("brands"),children:[e.jsxs(q,{className:"flex w-full items-center justify-between py-2",children:[e.jsx(I,{className:"text-sm font-medium",children:"Tags"}),e.jsx(Z,{className:`h-4 w-4 transition-transform ${u.brands?"rotate-180":""}`})]}),e.jsx(J,{className:"space-y-3 pt-2",children:e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:d.map(i=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{id:`brand-${i}`,checked:s.brands.includes(i),onCheckedChange:f=>c(i,f),className:"h-4 w-4 md:h-5 md:w-5"}),e.jsx(I,{htmlFor:`brand-${i}`,className:"text-sm font-normal",children:i})]},i))})})]})]})]})}function ya({filters:s,onRemoveFilter:t,onClearAll:a}){return s.categories.length>0||s.brands.length>0||s.availability.length>0||s.rating>0||s.discount>0||s.priceRange[0]>0||s.priceRange[1]<1e4||s.searchQuery.length>0?e.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-4 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Active filters:"}),s.searchQuery&&e.jsxs(_,{variant:"secondary",className:"gap-1",children:['Search: "',s.searchQuery,'"',e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("search",""),children:e.jsx(V,{className:"h-3 w-3"})})]}),s.categories.map(n=>e.jsxs(_,{variant:"secondary",className:"gap-1",children:[n,e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("category",n),children:e.jsx(V,{className:"h-3 w-3"})})]},n)),s.brands.map(n=>e.jsxs(_,{variant:"secondary",className:"gap-1",children:[n,e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("brand",n),children:e.jsx(V,{className:"h-3 w-3"})})]},n)),s.availability.map(n=>e.jsxs(_,{variant:"secondary",className:"gap-1",children:[n,e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("availability",n),children:e.jsx(V,{className:"h-3 w-3"})})]},n)),s.rating>0&&e.jsxs(_,{variant:"secondary",className:"gap-1",children:[s.rating,"+ ⭐",e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("rating",""),children:e.jsx(V,{className:"h-3 w-3"})})]}),s.discount>0&&e.jsxs(_,{variant:"secondary",className:"gap-1",children:[s.discount,"% off",e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("discount",""),children:e.jsx(V,{className:"h-3 w-3"})})]}),(s.priceRange[0]>0||s.priceRange[1]<1e4)&&e.jsxs(_,{variant:"secondary",className:"gap-1",children:["₹",s.priceRange[0]," - ₹",s.priceRange[1],e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("price",""),children:e.jsx(V,{className:"h-3 w-3"})})]}),e.jsx(D,{variant:"outline",size:"sm",onClick:a,className:"ml-2 bg-transparent",children:"Clear All"})]}):null}function ja(){const[s,t]=Fe(),[a,r]=g.useState({categories:[],brands:[],priceRange:[0,1e4],rating:0,discount:0,availability:[],searchQuery:""}),[n,h]=g.useState([]),[d,u]=g.useState(!0),[v,w]=g.useState(!1),{currentDepotId:S}=He(),{products:c,isLoading:y,error:i}=Ze(S);g.useEffect(()=>{const o=s.get("tag");if(console.log("URL tag parameter:",o),o&&c.length>0){const l=new Set;c.forEach(M=>{M.product.tags&&M.product.tags.split(",").map(A=>A.trim()).forEach(A=>l.add(A))});const N=Array.from(l).find(M=>M.toLowerCase()===o.toLowerCase())||o;console.log("Setting brand filter to:",N,"(original:",o,")"),r(M=>{const L={...M,brands:[N]};return console.log("New filters after URL param:",L),L})}else o||r(l=>({...l,brands:[]}))},[s,c]),g.useEffect(()=>{(async()=>{try{u(!0);const l=await Ye.getCategories();h(l)}catch(l){console.error("Failed to fetch categories:",l)}finally{u(!1)}})()},[]);const f=g.useMemo(()=>{const o=new Set;c.forEach(m=>{var L;const N=m.product;N.tags&&N.tags.split(",").map(x=>x.trim()).filter(x=>x.length>0).forEach(x=>{o.add(x),x.toLowerCase().includes("fruit")&&console.log(`Found fruit-related tag: "${x}" in product: ${N.name}`)}),N.isDairyProduct?o.add("Contains Dairy"):o.add("Non-Dairy");const M=N.name.split(" ")[0];M&&M.length>2&&!M.toLowerCase().includes("fresh")&&o.add(M),(L=N.category)!=null&&L.name&&o.add(N.category.name)});const l=Array.from(o).sort();return console.log("Available brands/tags:",l),console.log("Fruits-related brands:",l.filter(m=>m.toLowerCase().includes("fruit"))),l},[c]),b=g.useMemo(()=>{console.log("Filtering products with filters:",a),console.log("Total products to filter:",c.length),a.brands.some(l=>l.toLowerCase()==="fruits")&&(console.log("=== DEBUG: Fruits filter active ==="),console.log("All products and their tags:"),c.forEach((l,m)=>{console.log(`${m+1}. ${l.product.name}: tags="${l.product.tags}"`)}),console.log("Current brand filters:",a.brands),console.log("About to start filtering..."));const o=c.filter(l=>{var L,A;const m=l.product;if(a.categories.length>0&&!a.categories.some(P=>{var p;return((p=m.category)==null?void 0:p.name)===P})||a.brands.length>0&&!a.brands.some(P=>{const p=P.toLowerCase();p==="fruits"&&(console.log(`
=== Checking product: ${m.name} ===`),console.log(`Brand filter: "${P}" (lowercase: "${p}")`));const E=m.name.toLowerCase().includes(p);if(p==="fruits"){const R=["orange","oranges","apple","apples","banana","bananas","mango","mangoes","grape","grapes","fruit"].some(z=>m.name.toLowerCase().includes(z));if(console.log(`Name match: ${E}`),console.log(`Is fruit product (by name): ${R}`),R)return console.log(`✓ Matched as fruit product: ${m.name}`),!0}else p==="fruits"&&console.log(`Name match: ${E}`);let F=!1;if(m.tags){const T=m.tags.split(",").map(R=>R.trim().toLowerCase());(p==="fruits"||P.toLowerCase()==="fruits")&&(console.log(`Product: ${m.name}`),console.log(`Raw tags: "${m.tags}"`),console.log("Parsed tags:",T),console.log(`Looking for brand: "${P}" (lowercase: "${p}")`)),F=T.some(R=>{const z=R===p,re=R.includes(p)||p.includes(R),ne=z||re;return(p==="fruits"||P.toLowerCase()==="fruits")&&(console.log(`  Checking tag: "${R}" against "${p}"`),console.log(`    Exact match (${R} === ${p}): ${z}`),console.log(`    Contains match: ${re}`),console.log(`    Final result: ${ne}`)),ne})}if(p==="dairy"||p==="contains-dairy")return m.isDairyProduct===!0||F||E;if(p==="non-dairy")return m.isDairyProduct===!1||F||E;const B=E||F;return p==="fruits"&&(console.log(`Tag match: ${F}`),console.log(`Final match for ${m.name}: nameMatch=${E}, tagMatch=${F}, finalMatch=${B}`),console.log(`=== End ${m.name} ===
`)),B}))return!1;const N=l.buyOncePrice;if(N<a.priceRange[0]||N>a.priceRange[1]||a.rating>0&&4<a.rating||a.discount>0&&(l.discount?l.discount*100:0)<a.discount)return!1;if(a.availability.length>0){const x=a.availability.includes("In Stock")&&l.inStock,P=a.availability.includes("Same Day Delivery")&&l.inStock,p=a.availability.includes("Express Delivery")&&l.inStock,E=a.availability.includes("Bulk Available");if(!x&&!P&&!p&&!E)return!1}if(a.searchQuery){const x=a.searchQuery.toLowerCase(),P=m.name.toLowerCase().includes(x),p=(L=m.description)==null?void 0:L.toLowerCase().includes(x),E=(A=m.tags)==null?void 0:A.toLowerCase().includes(x);if(!P&&!p&&!E)return!1}return!0});return console.log(`Filtered ${o.length} products out of ${c.length}`),(a.brands.includes("Fruits")||a.brands.includes("fruits"))&&console.log("Products with Fruits filter:",o.map(l=>({name:l.product.name,tags:l.product.tags}))),o},[c,a]),j=o=>{const l=new URLSearchParams(s);o.brands.length>0?l.set("tag",o.brands[0]):l.delete("tag"),t(l)},C=(o,l)=>{let m;switch(o){case"category":m={...a,categories:a.categories.filter(N=>N!==l)};break;case"brand":m={...a,brands:a.brands.filter(N=>N!==l)};break;case"availability":m={...a,availability:a.availability.filter(N=>N!==l)};break;case"rating":m={...a,rating:0};break;case"discount":m={...a,discount:0};break;case"price":m={...a,priceRange:[0,1e4]};break;case"search":m={...a,searchQuery:""};break;default:return}r(m),j(m)},$=()=>{const o={categories:[],brands:[],priceRange:[0,1e4],rating:0,discount:0,availability:[],searchQuery:""};r(o),j(o)},k=(o,l,m)=>{console.log("Adding to cart:",{product:o.product.name,variant:l==null?void 0:l.name,quantity:m||1,price:(l==null?void 0:l.buyOncePrice)||o.buyOncePrice})};return y||d?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Loading products..."})]})}):i?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 mb-4",children:"Failed to load products"}),e.jsx(D,{onClick:()=>window.location.reload(),children:"Retry"})]})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{children:e.jsx(Qe,{})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"hidden lg:block lg:w-80 flex-shrink-0",children:e.jsx(ce,{filters:a,onFiltersChange:o=>{r(o),j(o)},onClearAll:$,categories:n,brands:f})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"lg:hidden mb-4",children:e.jsxs(_e,{open:v,onOpenChange:w,children:[e.jsx(Be,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:"w-full flex items-center justify-center gap-2 h-12 border-2 hover:bg-accent/50 hover:border-primary/30 transition-all duration-200",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Filters"}),(a.brands.length>0||a.categories.length>0||a.availability.length>0||a.rating>0||a.discount>0||a.searchQuery)&&e.jsx("span",{className:"ml-1 bg-primary text-primary-foreground text-xs px-2 py-0.5 rounded-full",children:[...a.brands,...a.categories,...a.availability,...a.rating>0?["Rating"]:[],...a.discount>0?["Discount"]:[],...a.searchQuery?["Search"]:[]].length})]})}),e.jsxs(Ie,{className:"max-h-[90vh] flex flex-col",children:[e.jsx(ze,{className:"text-left border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(W,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(Ve,{className:"text-lg font-semibold",children:"Filter Products"}),e.jsxs(Oe,{className:"text-sm text-muted-foreground",children:[b.length," of ",c.length," products"]})]})]}),(a.brands.length>0||a.categories.length>0||a.availability.length>0||a.rating>0||a.discount>0||a.searchQuery)&&e.jsxs(_,{variant:"secondary",className:"text-xs",children:[[...a.brands,...a.categories,...a.availability,...a.rating>0?["Rating"]:[],...a.discount>0?["Discount"]:[],...a.searchQuery?["Search"]:[]].length," active"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"p-4 space-y-6",children:e.jsx(ce,{filters:a,onFiltersChange:o=>{r(o),j(o)},onClearAll:$,categories:n,brands:f})})}),e.jsx(Ke,{className:"border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 p-4",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[(a.brands.length>0||a.categories.length>0||a.availability.length>0||a.rating>0||a.discount>0||a.searchQuery)&&e.jsx(D,{variant:"ghost",size:"sm",onClick:$,className:"self-start text-muted-foreground hover:text-foreground",children:"Clear all filters"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(ie,{asChild:!0,children:e.jsx(D,{variant:"outline",className:"flex-1",size:"lg",children:"Cancel"})}),e.jsx(ie,{asChild:!0,children:e.jsxs(D,{className:"flex-1",size:"lg",onClick:()=>w(!1),children:["Show ",b.length," Products"]})})]})]})})]})]})}),e.jsx(ya,{filters:a,onRemoveFilter:C,onClearAll:$}),e.jsx("div",{className:"flex items-center justify-between mb-6 mt-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Products (",b.length,")"]}),s.get("tag")&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Filtered by tag: ",e.jsx("span",{className:"font-medium",children:s.get("tag")})]})]})}),e.jsx(qe,{products:b,onAddToCart:k,isLoading:y}),b.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"No products found matching your filters."}),e.jsx(D,{variant:"outline",onClick:$,className:"mt-4 bg-transparent",children:"Clear All Filters"})]})]})]})}),e.jsx(Ue,{})]})}const ka=()=>e.jsx(Xe,{children:e.jsx(Ge,{children:e.jsx(ja,{})})});export{ka as default};
