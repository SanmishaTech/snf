import{R as L,j as e,r as u,c as $,b as M,B as A,p as F,I as B}from"./index-BtRkqcd7.js";import{u as T,a as q,H as R,F as _}from"./Footer-D0AQsJ6e.js";import{P as V}from"./ProductGrid-0clt8OIt.js";const W=()=>{const m=[{title:"Fresh groceries, delivered to your door",description:"Handpicked fruits, crisp vegetables, dairy, and daily essentials. Fast delivery, great prices, and quality you can trust.",primaryLabel:"Shop now",primaryHref:"#products",secondaryLabel:"View deals",secondaryHref:"#deals",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?q=80&w=1200&auto=format&fit=crop",alt:"Fresh produce assortment including fruits and vegetables",badge:"Up to 30% off today"},{title:"Daily essentials, right when you need them",description:"Milk, bread, eggs, snacks, and more — delivered fast with freshness guaranteed.",primaryLabel:"Browse essentials",primaryHref:"#essentials",secondaryLabel:"Today’s offers",secondaryHref:"#offers",image:"https://images.unsplash.com/photo-1506806732259-39c2d0268443?q=80&w=1200&auto=format&fit=crop",alt:"Assorted vegetables and herbs on a table",badge:"Fresh arrivals daily",imageOnly:!0},{title:"Quality you can trust",description:"Locally sourced produce and top brands — curated for your kitchen.",primaryLabel:"Explore categories",primaryHref:"#categories",secondaryLabel:"Best sellers",secondaryHref:"#bestsellers",image:"https://images.unsplash.com/photo-1511690656952-34342bb7c2f2?q=80&w=1200&auto=format&fit=crop",alt:"Grocery basket with assorted products",badge:"Top picks this week",imageOnly:!0}],[p,g]=L.useState(0),f=L.useRef(null),v=()=>{typeof window<"u"&&f.current!==null&&(window.clearInterval(f.current),f.current=null)},x=()=>{typeof window>"u"||(v(),f.current=window.setInterval(()=>{g(n=>(n+1)%m.length)},5e3))};L.useEffect(()=>(x(),v),[]);const w=()=>g(n=>(n-1+m.length)%m.length),y=()=>g(n=>(n+1)%m.length);return e.jsx("section",{className:"relative bg-gradient-to-br from-green-600 via-green-500 to-emerald-500 text-white",children:e.jsx("div",{className:"w-screen relative left-1/2 right-1/2 -ml-[50vw] -mr-[50vw] p-0",children:e.jsxs("div",{className:"relative overflow-hidden h-[22rem] sm:h-[26rem] md:h-[30rem] lg:h-[36rem] group",onMouseEnter:v,onMouseLeave:x,role:"region","aria-roledescription":"carousel","aria-label":"Hero promotions",children:[m.map((n,l)=>e.jsx("div",{className:`absolute inset-0 transition-all duration-700 ease-in-out transform ${l===p?"opacity-100 translate-x-0":"opacity-0 translate-x-6 pointer-events-none"}`,"aria-hidden":l!==p,children:n.imageOnly?e.jsx("img",{className:"w-full h-full object-cover",src:n.image,alt:n.alt,loading:l===p?"eager":"lazy",decoding:"async"}):e.jsxs("div",{className:"p-4 grid md:grid-cols-2 gap-8 items-center h-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-extrabold tracking-tight leading-tight",children:n.title}),e.jsx("p",{className:"mt-4 text-white/90 text-base md:text-lg",children:n.description}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[e.jsx("a",{href:n.primaryHref,className:"inline-flex items-center justify-center rounded-md bg-white text-green-700 font-medium h-10 px-6 shadow hover:shadow-md transition","aria-label":n.primaryLabel,children:n.primaryLabel}),e.jsx("a",{href:n.secondaryHref,className:"inline-flex items-center justify-center rounded-md border border-white/80 text-white font-medium h-10 px-6 hover:bg-white/10 transition","aria-label":n.secondaryLabel,children:n.secondaryLabel})]})]}),e.jsxs("div",{className:"relative h-full",children:[e.jsx("img",{className:"w-full h-full max-w-2xl max-h-2xl object-cover rounded-lg shadow-lg",src:n.image,alt:n.alt,loading:l===p?"eager":"lazy",decoding:"async"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 bg-white/90 text-green-700 px-4 py-2 rounded shadow md:text-lg font-semibold",children:n.badge})]})]})},n.title)),e.jsx("button",{type:"button","aria-label":"Previous slide",onClick:w,className:"hidden sm:flex absolute inset-y-0 left-2 z-10 items-center justify-center w-10 text-white/90 hover:text-white transition-opacity opacity-0 group-hover:opacity-100 focus:opacity-100",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M15 6l-6 6 6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("button",{type:"button","aria-label":"Next slide",onClick:y,className:"hidden sm:flex absolute inset-y-0 right-2 z-10 items-center justify-center w-10 text-white/90 hover:text-white transition-opacity opacity-0 group-hover:opacity-100 focus:opacity-100",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex items-center gap-2 z-10",children:m.map((n,l)=>e.jsx("button",{type:"button","aria-label":`Go to slide ${l+1}`,onClick:()=>g(l),"aria-current":l===p,className:`h-2.5 w-2.5 rounded-full transition-all ${l===p?"bg-white":"bg-white/50 hover:bg-white/70"}`},l))})]})})})},D=()=>{const[m,p]=u.useState(""),[g,f]=u.useState([]),[v]=u.useState("relevance"),[x,w]=u.useState(null),y=$(),n=M(),[l,S]=u.useState([]),[P,j]=u.useState(!1),[I,N]=u.useState(null),{state:b}=T(),{addItem:H,state:O}=q(),k=b.products.map(t=>{const a=b.depotVariants.filter(d=>d.productId===t.id),s=a.filter(d=>!d.notInStock&&!d.isHidden),r=s.map(d=>{const h=d.buyOncePrice||d.mrp||0;return typeof h=="number"&&isFinite(h)&&h>0?h:0}).filter(d=>d>0),i=r.length>0?Math.min(...r):0,o=s.length>0,c=s.map(d=>{const h=d.mrp||0;return typeof h=="number"&&isFinite(h)&&h>0?h:0}).filter(d=>d>0),C=c.length>0?Math.max(...c):0;return{product:t,variants:a,buyOncePrice:i,mrp:C,inStock:o,deliveryTime:"Same day delivery"}}),z=b.isLoading;u.useEffect(()=>{(async()=>{j(!0),N(null);try{const a=await F.getCategories(),r=[...(Array.isArray(a)?a:[]).map(i=>({id:String(i.id??i._id??i.slug??""),name:i.name||i.title||"Category",imageUrl:i.imageUrl||i.attachmentUrl||i.iconUrl||i.url||void 0}))].sort((i,o)=>{const c=typeof i.name=="string"&&i.name.toLowerCase().includes("milk")?1:0,C=typeof o.name=="string"&&o.name.toLowerCase().includes("milk")?1:0;return c!==C?C-c:(i.name||"").localeCompare(o.name||"")});S(r)}catch(a){N((a==null?void 0:a.message)||"Failed to load categories")}finally{j(!1)}})()},[]),u.useEffect(()=>{!b.userLocation&&b.isLoading},[b.userLocation,b.isLoading]),u.useEffect(()=>{const t=(y.hash||"").replace("#","");if(!t)return;if(t.startsWith("category-")){const r=t.slice(9),i=parseInt(r,10);Number.isFinite(i)&&f([i])}const a=()=>{const r=document.getElementById(t);r&&r.scrollIntoView({behavior:"smooth",block:"start"})};a();const s=setTimeout(a,150);return()=>clearTimeout(s)},[y.hash,P,l.length]),u.useEffect(()=>{const a=new URLSearchParams(y.search||"").get("tag");if(!a){w(null);return}const s=a.toLowerCase().trim();if(s.startsWith("category:")){const o=s.split(":")[1],c=parseInt(o||"",10);Number.isFinite(c)&&f([c]),w(null)}else w(s);const r=()=>{const o=document.getElementById("products");o&&o.scrollIntoView({behavior:"smooth",block:"start"})};r();const i=setTimeout(r,120);return()=>clearTimeout(i)},[y.search]);const E=u.useMemo(()=>{let t=k;if(m.trim()){const s=m.trim().toLowerCase();t=t.filter(r=>r.product.name.toLowerCase().includes(s)||(r.product.description?r.product.description.toLowerCase().includes(s):!1))}if(g.length>0&&(t=t.filter(s=>g.includes(s.product.categoryId||0))),x)if(x==="non-dairy")t=t.filter(s=>!s.product.isDairyProduct);else if(x==="contains-dairy")t=t.filter(s=>!!s.product.isDairyProduct);else{const s=x.toLowerCase().trim();t=t.filter(r=>{const i=r.product.tags;if(!i)return!1;const o=i.split(",").map(c=>c.trim().toLowerCase()).filter(Boolean);return s==="pasteurized"||s==="pasturized"?o.includes("pasteurized")||o.includes("pasturized"):o.includes(s)})}const a=[...t];switch(v){case"price_asc":a.sort((s,r)=>s.buyOncePrice-r.buyOncePrice);break;case"price_desc":a.sort((s,r)=>r.buyOncePrice-s.buyOncePrice);break;case"popularity_desc":a.sort((s,r)=>(r.product.id||0)-(s.product.id||0));break;case"relevance":default:a.sort((s,r)=>s.buyOncePrice!==r.buyOncePrice?s.buyOncePrice-r.buyOncePrice:(s.product.id||0)-(r.product.id||0));break}return a},[k,m,g,v,x]),U=(t,a,s)=>{a&&H(t,a,s||1)};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[e.jsx(R,{cartCount:O.items.reduce((t,a)=>t+a.quantity,0),onSearch:p}),e.jsxs("main",{className:"flex-1",children:[e.jsx(W,{}),e.jsxs("section",{className:"container mx-auto px-4 md:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-semibold",children:"Browse by Category"}),I&&e.jsx(A,{size:"sm",variant:"outline",onClick:()=>{j(!0),F.getCategories().then(t=>{const s=[...(Array.isArray(t)?t:[]).map(r=>({id:String(r.id??r._id??r.slug??""),name:r.name||r.title||"Category",imageUrl:r.imageUrl||r.attachmentUrl||r.iconUrl||r.url||void 0}))].sort((r,i)=>{const o=typeof r.name=="string"&&r.name.toLowerCase().includes("milk")?1:0,c=typeof i.name=="string"&&i.name.toLowerCase().includes("milk")?1:0;return o!==c?c-o:(r.name||"").localeCompare(i.name||"")});S(s),N(null)}).catch(t=>N((t==null?void 0:t.message)||"Failed to load categories")).finally(()=>j(!1))},children:"Retry"})]}),P?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:Array.from({length:12}).map((t,a)=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"aspect-square w-full rounded-lg bg-muted/30"}),e.jsx("div",{className:"h-3 w-2/3 bg-muted/40 rounded mt-3"})]},a))}):e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs("button",{id:"category-all",type:"button",onClick:()=>{f([]),w(null);const t=new URLSearchParams(y.search||"");t.delete("tag"),n({search:t.toString()?`?${t.toString()}`:""},{replace:!0})},className:"group text-left","aria-label":"Show all products",children:[e.jsx("div",{className:`relative aspect-square w-full overflow-hidden rounded-full border bg-accent/10 ${g.length===0?"ring-2 ring-primary border-primary":""}`,children:e.jsx("div",{className:"h-full w-full grid place-items-center text-muted-foreground bg-gradient-to-br from-muted/30 to-transparent rounded-full",children:"All"})}),e.jsx("div",{className:"mt-3 text-center",children:e.jsx("p",{className:`text-sm font-medium line-clamp-2 transition-colors ${g.length===0?"text-primary":"group-hover:text-primary"}`,children:"All"})})]},"all"),l.map(t=>{var r;const a=parseInt(t.id,10),s=g.includes(a);return e.jsxs("a",{id:`category-${a}`,href:`/snf/category/${a}`,className:"group text-left","aria-label":`Filter by category ${t.name}`,children:[e.jsx("div",{className:`relative aspect-square w-full overflow-hidden rounded-full border bg-accent/10 ${s?"ring-2 ring-primary border-primary":""}`,children:t.imageUrl?e.jsx("img",{src:`http://localhost:3000${t.imageUrl}`,alt:t.name,className:" h-full w-full  object-cover rounded-full transition-transform duration-300 group-hover:scale-[1.03]",loading:"lazy"}):e.jsx("div",{className:"h-full w-full grid place-items-center text-muted-foreground bg-gradient-to-br from-muted/30 to-transparent rounded-full",children:((r=t.name)==null?void 0:r.charAt(0))||"C"})}),e.jsx("div",{className:"mt-3 text-center",children:e.jsx("p",{className:`text-sm font-medium line-clamp-2 transition-colors ${s?"text-primary":"group-hover:text-primary"}`,children:t.name})})]},t.id)}),l.length===0&&!I&&e.jsx("p",{className:"col-span-2 sm:col-span-3 lg:col-span-6 text-muted-foreground",children:"No categories available."})]})]}),e.jsxs("section",{className:"container mx-auto px-4 md:px-6 lg:px-8",children:[e.jsx("div",{className:"h-px w-full bg-border/60"}),e.jsx("div",{className:"flex items-end justify-between py-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl md:text-2xl font-semibold",children:"Products"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click a category above to filter products below"})]})})]}),e.jsxs("section",{id:"products",className:"container mx-auto px-3 sm:px-4 md:px-6 lg:px-8 py-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx(B,{value:m,onChange:t=>p(t.target.value),placeholder:"Search products","aria-label":"Search products"})}),z&&k.length===0?e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:Array.from({length:8}).map((t,a)=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"aspect-[4/3] w-full rounded-lg bg-muted/30"}),e.jsx("div",{className:"h-3 w-3/4 bg-muted/40 rounded mt-3"})]},a))})}):e.jsx("div",{className:"",children:e.jsx(V,{products:E,onAddToCart:U,isLoading:z})})]})]}),e.jsx(_,{})]})},K=()=>e.jsx(D,{});export{K as default};
