import{r as f,$ as Se,j as e,a0 as Ce,a1 as Pe,a2 as $,a3 as Q,a4 as H,a5 as Re,a6 as le,a7 as ke,a8 as De,a9 as G,d as Me,e as Ae,f as Ee,aa as ee,K as B,B as A,h as Le,J as O,ab as Fe,I as X,ac as q,ad as J,ae as Z,af as W,ag as re,ah as z,a as Ie,U as Te,ai as _e,aj as Be,ak as Oe,al as Ve,am as ze,an as $e,ao as Ke,ap as oe,w as ie}from"./index-DA0rZHy4.js";import{u as He,b as Qe,H as Ue,F as Ye,p as Ge,P as Xe,C as qe}from"./Footer-PGRWDOnl.js";import{P as Je}from"./ProductGrid-DfylD_4M.js";import{a as Ze}from"./useProducts-DZSlQU6g.js";import"./ProductCard-Djg66Zav.js";var de=["PageUp","PageDown"],ue=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],me={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},K="Slider",[ae,We,ea]=Pe(K),[he,ka]=Ce(K,[ea]),[aa,U]=he(K),ge=f.forwardRef((t,s)=>{const{name:a,min:n=0,max:r=100,step:h=1,orientation:c="horizontal",disabled:l=!1,minStepsBetweenThumbs:p=0,defaultValue:S=[n],value:k,onValueChange:m=()=>{},onValueCommit:d=()=>{},inverted:o=!1,form:b,...v}=t,C=f.useRef(new Set),N=f.useRef(0),D=c==="horizontal"?ta:sa,[P=[],V]=Se({prop:k,defaultProp:S,onChange:y=>{var j;(j=[...C.current][N.current])==null||j.focus(),m(y)}}),i=f.useRef(P);function u(y){const M=ca(P,y);w(y,M)}function g(y){w(y,N.current)}function x(){const y=i.current[N.current];P[N.current]!==y&&d(P)}function w(y,M,{commit:j}={commit:!1}){const E=ma(h),R=ha(Math.round((y-n)/h)*h+n,E),L=le(R,[n,r]);V((I=[])=>{const T=oa(I,L,M);if(ua(T,p*h)){N.current=T.indexOf(L);const _=String(T)!==String(I);return _&&j&&d(T),_?T:I}else return I})}return e.jsx(aa,{scope:t.__scopeSlider,name:a,disabled:l,min:n,max:r,valueIndexToChangeRef:N,thumbs:C.current,values:P,orientation:c,form:b,children:e.jsx(ae.Provider,{scope:t.__scopeSlider,children:e.jsx(ae.Slot,{scope:t.__scopeSlider,children:e.jsx(D,{"aria-disabled":l,"data-disabled":l?"":void 0,...v,ref:s,onPointerDown:$(v.onPointerDown,()=>{l||(i.current=P)}),min:n,max:r,inverted:o,onSlideStart:l?void 0:u,onSlideMove:l?void 0:g,onSlideEnd:l?void 0:x,onHomeKeyDown:()=>!l&&w(n,0,{commit:!0}),onEndKeyDown:()=>!l&&w(r,P.length-1,{commit:!0}),onStepKeyDown:({event:y,direction:M})=>{if(!l){const R=de.includes(y.key)||y.shiftKey&&ue.includes(y.key)?10:1,L=N.current,I=P[L],T=h*R*M;w(I+T,L,{commit:!0})}}})})})})});ge.displayName=K;var[fe,xe]=he(K,{startEdge:"left",endEdge:"right",size:"width",direction:1}),ta=f.forwardRef((t,s)=>{const{min:a,max:n,dir:r,inverted:h,onSlideStart:c,onSlideMove:l,onSlideEnd:p,onStepKeyDown:S,...k}=t,[m,d]=f.useState(null),o=H(s,D=>d(D)),b=f.useRef(void 0),v=Re(r),C=v==="ltr",N=C&&!h||!C&&h;function F(D){const P=b.current||m.getBoundingClientRect(),V=[0,P.width],u=ne(V,N?[a,n]:[n,a]);return b.current=P,u(D-P.left)}return e.jsx(fe,{scope:t.__scopeSlider,startEdge:N?"left":"right",endEdge:N?"right":"left",direction:N?1:-1,size:"width",children:e.jsx(pe,{dir:v,"data-orientation":"horizontal",...k,ref:o,style:{...k.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:D=>{const P=F(D.clientX);c==null||c(P)},onSlideMove:D=>{const P=F(D.clientX);l==null||l(P)},onSlideEnd:()=>{b.current=void 0,p==null||p()},onStepKeyDown:D=>{const V=me[N?"from-left":"from-right"].includes(D.key);S==null||S({event:D,direction:V?-1:1})}})})}),sa=f.forwardRef((t,s)=>{const{min:a,max:n,inverted:r,onSlideStart:h,onSlideMove:c,onSlideEnd:l,onStepKeyDown:p,...S}=t,k=f.useRef(null),m=H(s,k),d=f.useRef(void 0),o=!r;function b(v){const C=d.current||k.current.getBoundingClientRect(),N=[0,C.height],D=ne(N,o?[n,a]:[a,n]);return d.current=C,D(v-C.top)}return e.jsx(fe,{scope:t.__scopeSlider,startEdge:o?"bottom":"top",endEdge:o?"top":"bottom",size:"height",direction:o?1:-1,children:e.jsx(pe,{"data-orientation":"vertical",...S,ref:m,style:{...S.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:v=>{const C=b(v.clientY);h==null||h(C)},onSlideMove:v=>{const C=b(v.clientY);c==null||c(C)},onSlideEnd:()=>{d.current=void 0,l==null||l()},onStepKeyDown:v=>{const N=me[o?"from-bottom":"from-top"].includes(v.key);p==null||p({event:v,direction:N?-1:1})}})})}),pe=f.forwardRef((t,s)=>{const{__scopeSlider:a,onSlideStart:n,onSlideMove:r,onSlideEnd:h,onHomeKeyDown:c,onEndKeyDown:l,onStepKeyDown:p,...S}=t,k=U(K,a);return e.jsx(Q.span,{...S,ref:s,onKeyDown:$(t.onKeyDown,m=>{m.key==="Home"?(c(m),m.preventDefault()):m.key==="End"?(l(m),m.preventDefault()):de.concat(ue).includes(m.key)&&(p(m),m.preventDefault())}),onPointerDown:$(t.onPointerDown,m=>{const d=m.target;d.setPointerCapture(m.pointerId),m.preventDefault(),k.thumbs.has(d)?d.focus():n(m)}),onPointerMove:$(t.onPointerMove,m=>{m.target.hasPointerCapture(m.pointerId)&&r(m)}),onPointerUp:$(t.onPointerUp,m=>{const d=m.target;d.hasPointerCapture(m.pointerId)&&(d.releasePointerCapture(m.pointerId),h(m))})})}),be="SliderTrack",ve=f.forwardRef((t,s)=>{const{__scopeSlider:a,...n}=t,r=U(be,a);return e.jsx(Q.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...n,ref:s})});ve.displayName=be;var te="SliderRange",ye=f.forwardRef((t,s)=>{const{__scopeSlider:a,...n}=t,r=U(te,a),h=xe(te,a),c=f.useRef(null),l=H(s,c),p=r.values.length,S=r.values.map(d=>we(d,r.min,r.max)),k=p>1?Math.min(...S):0,m=100-Math.max(...S);return e.jsx(Q.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...n,ref:l,style:{...t.style,[h.startEdge]:k+"%",[h.endEdge]:m+"%"}})});ye.displayName=te;var se="SliderThumb",je=f.forwardRef((t,s)=>{const a=We(t.__scopeSlider),[n,r]=f.useState(null),h=H(s,l=>r(l)),c=f.useMemo(()=>n?a().findIndex(l=>l.ref.current===n):-1,[a,n]);return e.jsx(na,{...t,ref:h,index:c})}),na=f.forwardRef((t,s)=>{const{__scopeSlider:a,index:n,name:r,...h}=t,c=U(se,a),l=xe(se,a),[p,S]=f.useState(null),k=H(s,F=>S(F)),m=p?c.form||!!p.closest("form"):!0,d=ke(p),o=c.values[n],b=o===void 0?0:we(o,c.min,c.max),v=ia(n,c.values.length),C=d==null?void 0:d[l.size],N=C?la(C,b,l.direction):0;return f.useEffect(()=>{if(p)return c.thumbs.add(p),()=>{c.thumbs.delete(p)}},[p,c.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${b}% + ${N}px)`},children:[e.jsx(ae.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(Q.span,{role:"slider","aria-label":t["aria-label"]||v,"aria-valuemin":c.min,"aria-valuenow":o,"aria-valuemax":c.max,"aria-orientation":c.orientation,"data-orientation":c.orientation,"data-disabled":c.disabled?"":void 0,tabIndex:c.disabled?void 0:0,...h,ref:k,style:o===void 0?{display:"none"}:t.style,onFocus:$(t.onFocus,()=>{c.valueIndexToChangeRef.current=n})})}),m&&e.jsx(ra,{name:r??(c.name?c.name+(c.values.length>1?"[]":""):void 0),form:c.form,value:o},n)]})});je.displayName=se;var ra=t=>{const{value:s,...a}=t,n=f.useRef(null),r=De(s);return f.useEffect(()=>{const h=n.current,c=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(c,"value").set;if(r!==s&&p){const S=new Event("input",{bubbles:!0});p.call(h,s),h.dispatchEvent(S)}},[r,s]),e.jsx("input",{style:{display:"none"},...a,ref:n,defaultValue:s})};function oa(t=[],s,a){const n=[...t];return n[a]=s,n.sort((r,h)=>r-h)}function we(t,s,a){const h=100/(a-s)*(t-s);return le(h,[0,100])}function ia(t,s){return s>2?`Value ${t+1} of ${s}`:s===2?["Minimum","Maximum"][t]:void 0}function ca(t,s){if(t.length===1)return 0;const a=t.map(r=>Math.abs(r-s)),n=Math.min(...a);return a.indexOf(n)}function la(t,s,a){const n=t/2,h=ne([0,50],[0,n]);return(n-h(s)*a)*a}function da(t){return t.slice(0,-1).map((s,a)=>t[a+1]-s)}function ua(t,s){if(s>0){const a=da(t);return Math.min(...a)>=s}return!0}function ne(t,s){return a=>{if(t[0]===t[1]||s[0]===s[1])return s[0];const n=(s[1]-s[0])/(t[1]-t[0]);return s[0]+n*(a-t[0])}}function ma(t){return(String(t).split(".")[1]||"").length}function ha(t,s){const a=Math.pow(10,s);return Math.round(t*a)/a}var ga=ge,fa=ve,xa=ye,pa=je;function ba({className:t,defaultValue:s,value:a,min:n=0,max:r=100,...h}){const c=f.useMemo(()=>Array.isArray(a)?a:Array.isArray(s)?s:[n,r],[a,s,n,r]);return e.jsxs(ga,{"data-slot":"slider",defaultValue:s,value:a,min:n,max:r,className:G("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",t),...h,children:[e.jsx(fa,{"data-slot":"slider-track",className:G("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(xa,{"data-slot":"slider-range",className:G("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:c.length},(l,p)=>e.jsx(pa,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},p))]})}const va=["Fruits & Vegetables","Dairy & Eggs","Meat & Seafood","Bakery","Beverages","Snacks","Frozen Foods","Personal Care","Household","Baby Care"],ya=["Amul","Britannia","Nestle","ITC","Parle","Haldiram's","MTR","Organic India","24 Mantra","Fresho"];function ce({filters:t,onFiltersChange:s,onClearAll:a,categories:n,brands:r}){const h=(n==null?void 0:n.map(o=>o.name))||va,c=r||ya,[l,p]=f.useState({categories:!0,brands:!0,price:!0,rating:!0,discount:!1,availability:!1}),S=o=>{p(b=>({...b,[o]:!b[o]}))},k=(o,b)=>{const v=b?[...t.categories,o]:t.categories.filter(C=>C!==o);s({...t,categories:v})},m=(o,b)=>{const v=b?[...t.brands,o]:t.brands.filter(C=>C!==o);s({...t,brands:v})},d=t.categories.length+t.brands.length+t.availability.length+(t.rating>0?1:0)+(t.discount>0?1:0)+(t.priceRange[0]>0||t.priceRange[1]<1e4?1:0);return e.jsxs(Me,{className:"w-full max-w-sm",children:[e.jsx(Ae,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ee,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Filters",d>0&&e.jsx(B,{variant:"secondary",className:"ml-2",children:d})]}),d>0&&e.jsx(A,{variant:"ghost",size:"sm",onClick:a,children:"Clear All"})]})}),e.jsxs(Le,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"search",children:"Search Products"}),e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(X,{id:"search",placeholder:"Search for products...",value:t.searchQuery,onChange:o=>s({...t,searchQuery:o.target.value}),className:"pl-10"})]})]}),e.jsxs(q,{open:l.categories,onOpenChange:()=>S("categories"),children:[e.jsxs(J,{className:"flex w-full items-center justify-between py-2",children:[e.jsx(O,{className:"text-sm font-medium",children:"Categories"}),e.jsx(Z,{className:`h-4 w-4 transition-transform ${l.categories?"rotate-180":""}`})]}),e.jsx(W,{className:"space-y-3 pt-2",children:e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:h.map(o=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{id:`category-${o}`,checked:t.categories.includes(o),onCheckedChange:b=>k(o,b),className:"h-4 w-4 md:h-5 md:w-5"}),e.jsx(O,{htmlFor:`category-${o}`,className:"text-sm font-normal",children:o})]},o))})})]}),e.jsxs(q,{open:l.price,onOpenChange:()=>S("price"),children:[e.jsxs(J,{className:"flex w-full items-center justify-between py-2",children:[e.jsx(O,{className:"text-sm font-medium",children:"Price Range"}),e.jsx(Z,{className:`h-4 w-4 transition-transform ${l.price?"rotate-180":""}`})]}),e.jsx(W,{className:"space-y-4 pt-2",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(O,{htmlFor:"min-price",className:"text-xs text-muted-foreground",children:"Min"}),e.jsx(X,{id:"min-price",type:"number",placeholder:"0",value:t.priceRange[0]||"",onChange:o=>{const b=Math.max(0,parseInt(o.target.value)||0),v=Math.max(b,t.priceRange[1]);s({...t,priceRange:[b,v]})},className:"h-8 text-sm"})]}),e.jsx("span",{className:"text-muted-foreground mt-4",children:"-"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(O,{htmlFor:"max-price",className:"text-xs text-muted-foreground",children:"Max"}),e.jsx(X,{id:"max-price",type:"number",placeholder:"10000",value:t.priceRange[1]||"",onChange:o=>{const b=Math.min(1e4,parseInt(o.target.value)||1e4),v=Math.min(b,t.priceRange[0]);s({...t,priceRange:[v,b]})},className:"h-8 text-sm"})]})]}),e.jsxs("div",{className:"px-2",children:[e.jsx(ba,{value:t.priceRange,onValueChange:o=>s({...t,priceRange:o}),max:1e4,min:0,step:50,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground mt-2",children:[e.jsxs("span",{children:["₹",t.priceRange[0]]}),e.jsxs("span",{children:["₹",t.priceRange[1]]})]})]})]})})]}),e.jsxs(q,{open:l.brands,onOpenChange:()=>S("brands"),children:[e.jsxs(J,{className:"flex w-full items-center justify-between py-2",children:[e.jsx(O,{className:"text-sm font-medium",children:"Tags"}),e.jsx(Z,{className:`h-4 w-4 transition-transform ${l.brands?"rotate-180":""}`})]}),e.jsx(W,{className:"space-y-3 pt-2",children:e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:c.map(o=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{id:`brand-${o}`,checked:t.brands.includes(o),onCheckedChange:b=>m(o,b),className:"h-4 w-4 md:h-5 md:w-5"}),e.jsx(O,{htmlFor:`brand-${o}`,className:"text-sm font-normal",children:o})]},o))})})]})]})]})}function ja({filters:t,onRemoveFilter:s,onClearAll:a}){return t.categories.length>0||t.brands.length>0||t.availability.length>0||t.rating>0||t.discount>0||t.priceRange[0]>0||t.priceRange[1]<1e4||t.searchQuery.length>0?e.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-4 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Active filters:"}),t.searchQuery&&e.jsxs(B,{variant:"secondary",className:"gap-1",children:['Search: "',t.searchQuery,'"',e.jsx(A,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>s("search",""),children:e.jsx(z,{className:"h-3 w-3"})})]}),t.categories.map(r=>e.jsxs(B,{variant:"secondary",className:"gap-1",children:[r,e.jsx(A,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>s("category",r),children:e.jsx(z,{className:"h-3 w-3"})})]},r)),t.brands.map(r=>e.jsxs(B,{variant:"secondary",className:"gap-1",children:[r,e.jsx(A,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>s("brand",r),children:e.jsx(z,{className:"h-3 w-3"})})]},r)),t.availability.map(r=>e.jsxs(B,{variant:"secondary",className:"gap-1",children:[r,e.jsx(A,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>s("availability",r),children:e.jsx(z,{className:"h-3 w-3"})})]},r)),t.rating>0&&e.jsxs(B,{variant:"secondary",className:"gap-1",children:[t.rating,"+ ⭐",e.jsx(A,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>s("rating",""),children:e.jsx(z,{className:"h-3 w-3"})})]}),t.discount>0&&e.jsxs(B,{variant:"secondary",className:"gap-1",children:[t.discount,"% off",e.jsx(A,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>s("discount",""),children:e.jsx(z,{className:"h-3 w-3"})})]}),(t.priceRange[0]>0||t.priceRange[1]<1e4)&&e.jsxs(B,{variant:"secondary",className:"gap-1",children:["₹",t.priceRange[0]," - ₹",t.priceRange[1],e.jsx(A,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>s("price",""),children:e.jsx(z,{className:"h-3 w-3"})})]}),e.jsx(A,{variant:"outline",size:"sm",onClick:a,className:"ml-2 bg-transparent",children:"Clear All"})]}):null}function wa(){const[t,s]=Ie(),[a,n]=f.useState({categories:[],brands:[],priceRange:[0,1e4],rating:0,discount:0,availability:[],searchQuery:""}),[r,h]=f.useState([]),[c,l]=f.useState(!0),[p,S]=f.useState(!1),{currentDepotId:k}=He(),{addItem:m}=Qe(),{products:d,isLoading:o,error:b}=Ze(k);f.useEffect(()=>{const i=t.get("tag");if(console.log("URL tag parameter:",i),i&&d.length>0){const u=new Set;d.forEach(w=>{w.product.tags&&w.product.tags.split(",").map(M=>M.trim()).forEach(M=>u.add(M))});const x=Array.from(u).find(w=>w.toLowerCase()===i.toLowerCase())||i;console.log("Setting brand filter to:",x,"(original:",i,")"),n(w=>{const y={...w,brands:[x]};return console.log("New filters after URL param:",y),y})}else i||n(u=>({...u,brands:[]}))},[t,d]),f.useEffect(()=>{(async()=>{try{l(!0);const u=await Ge.getCategories();h(u)}catch(u){console.error("Failed to fetch categories:",u)}finally{l(!1)}})()},[]);const v=f.useMemo(()=>{if(d.length===0)return[0,1e4];const i=d.map(y=>y.buyOncePrice).filter(y=>y>0);if(i.length===0)return[0,1e4];const u=Math.min(...i),g=Math.max(...i),x=Math.floor(u/10)*10,w=Math.ceil(g/100)*100;return console.log("Dynamic price range:",{minPrice:u,maxPrice:g,paddedMin:x,paddedMax:w}),[x,w]},[d]);f.useEffect(()=>{d.length>0&&n(i=>({...i,priceRange:v}))},[v,d.length]);const C=f.useMemo(()=>{const i=new Set;d.forEach(g=>{var y;const x=g.product;x.tags&&x.tags.split(",").map(j=>j.trim()).filter(j=>j.length>0).forEach(j=>{i.add(j),j.toLowerCase().includes("fruit")&&console.log(`Found fruit-related tag: "${j}" in product: ${x.name}`)}),x.isDairyProduct?i.add("Contains Dairy"):i.add("Non-Dairy");const w=x.name.split(" ")[0];w&&w.length>2&&!w.toLowerCase().includes("fresh")&&i.add(w),(y=x.category)!=null&&y.name&&i.add(x.category.name)});const u=Array.from(i).sort();return console.log("Available brands/tags:",u),console.log("Fruits-related brands:",u.filter(g=>g.toLowerCase().includes("fruit"))),u},[d]),N=f.useMemo(()=>{console.log("=== FILTERING PRODUCTS (VARIANT-LEVEL) ==="),console.log("Current filters:",a),console.log("Price range filter:",a.priceRange),console.log("Total products to filter:",d.length);const i=d.map(u=>{var y,M;const g=u.product;if(a.categories.length>0&&!a.categories.some(E=>{var R;return((R=g.category)==null?void 0:R.name)===E})||a.brands.length>0&&!a.brands.some(E=>{const R=E.toLowerCase(),L=g.name.toLowerCase().includes(R);if(R==="fruits"&&["orange","oranges","apple","apples","banana","bananas","mango","mangoes","grape","grapes","fruit"].some(Y=>g.name.toLowerCase().includes(Y)))return!0;let I=!1;return g.tags&&(I=g.tags.split(",").map(_=>_.trim().toLowerCase()).some(_=>{const Y=_===R,Ne=_.includes(R)||R.includes(_);return Y||Ne})),R==="dairy"||R==="contains-dairy"?g.isDairyProduct===!0||I||L:R==="non-dairy"?g.isDairyProduct===!1||I||L:L||I}))return null;let x=u.variants||[];if((a.priceRange[0]>0||a.priceRange[1]<Number.MAX_SAFE_INTEGER)&&(x=x.filter(j=>{const E=j.buyOncePrice||u.buyOncePrice||0,R=E>=a.priceRange[0]&&E<=a.priceRange[1];return g.name.toLowerCase().includes("milk")&&(console.log(`[Variant Filter] ${g.name} - ${j.name}`),console.log(`  Variant price: ₹${E}`),console.log(`  Filter range: ₹${a.priceRange[0]} - ₹${a.priceRange[1]}`),console.log(`  In range: ${R}`)),R})),x.length===0||a.rating>0&&4<a.rating||a.discount>0&&(u.discount?u.discount*100:0)<a.discount)return null;if(a.availability.length>0){const j=a.availability.includes("In Stock")&&u.inStock,E=a.availability.includes("Same Day Delivery")&&u.inStock,R=a.availability.includes("Express Delivery")&&u.inStock,L=a.availability.includes("Bulk Available");if(!j&&!E&&!R&&!L)return null}if(a.searchQuery){const j=a.searchQuery.toLowerCase(),E=g.name.toLowerCase().includes(j),R=(y=g.description)==null?void 0:y.toLowerCase().includes(j),L=(M=g.tags)==null?void 0:M.toLowerCase().includes(j);if(!E&&!R&&!L)return null}return{...u,variants:x,buyOncePrice:Math.min(...x.map(j=>j.buyOncePrice||u.buyOncePrice||0))}}).filter(Boolean);return console.log(`Filtered ${i.length} products out of ${d.length}`),i},[d,a]),F=i=>{const u=new URLSearchParams(t);i.brands.length>0?u.set("tag",i.brands[0]):u.delete("tag"),s(u)},D=(i,u)=>{let g;switch(i){case"category":g={...a,categories:a.categories.filter(x=>x!==u)};break;case"brand":g={...a,brands:a.brands.filter(x=>x!==u)};break;case"availability":g={...a,availability:a.availability.filter(x=>x!==u)};break;case"rating":g={...a,rating:0};break;case"discount":g={...a,discount:0};break;case"price":g={...a,priceRange:v};break;case"search":g={...a,searchQuery:""};break;default:return}n(g),F(g)},P=()=>{const i={categories:[],brands:[],priceRange:v,rating:0,discount:0,availability:[],searchQuery:""};n(i),F(i)},V=(i,u,g)=>{try{const x=g||1,w=u||{id:i.product.id,name:"Default",buyOncePrice:i.buyOncePrice,mrp:i.buyOncePrice,inStock:i.inStock,isActive:!0};m(i,w,x),ie.success(`Added ${i.product.name} to cart`),console.log("Successfully added to cart:",{product:i.product.name,variant:w==null?void 0:w.name,quantity:x,price:w.buyOncePrice})}catch(x){console.error("Failed to add item to cart:",x),ie.error("Failed to add item to cart")}};return o||c?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Loading products..."})]})}):b?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 mb-4",children:"Failed to load products"}),e.jsx(A,{onClick:()=>window.location.reload(),children:"Retry"})]})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{children:e.jsx(Ue,{})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"hidden lg:block lg:w-80 flex-shrink-0",children:e.jsx(ce,{filters:a,onFiltersChange:i=>{n(i),F(i)},onClearAll:P,categories:r,brands:C})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"lg:hidden mb-4",children:e.jsxs(_e,{open:p,onOpenChange:S,children:[e.jsx(Be,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:"w-full flex items-center justify-center gap-2 h-12 border-2 hover:bg-accent/50 hover:border-primary/30 transition-all duration-200",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Filters"}),(a.brands.length>0||a.categories.length>0||a.availability.length>0||a.rating>0||a.discount>0||a.searchQuery)&&e.jsx("span",{className:"ml-1 bg-primary text-primary-foreground text-xs px-2 py-0.5 rounded-full",children:[...a.brands,...a.categories,...a.availability,...a.rating>0?["Rating"]:[],...a.discount>0?["Discount"]:[],...a.searchQuery?["Search"]:[]].length})]})}),e.jsxs(Oe,{className:"max-h-[90vh] flex flex-col",children:[e.jsx(Ve,{className:"text-left border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(ee,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(ze,{className:"text-lg font-semibold",children:"Filter Products"}),e.jsxs($e,{className:"text-sm text-muted-foreground",children:[N.length," of ",d.length," products"]})]})]}),(a.brands.length>0||a.categories.length>0||a.availability.length>0||a.rating>0||a.discount>0||a.searchQuery)&&e.jsxs(B,{variant:"secondary",className:"text-xs",children:[[...a.brands,...a.categories,...a.availability,...a.rating>0?["Rating"]:[],...a.discount>0?["Discount"]:[],...a.searchQuery?["Search"]:[]].length," active"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"p-4 space-y-6",children:e.jsx(ce,{filters:a,onFiltersChange:i=>{n(i),F(i)},onClearAll:P,categories:r,brands:C})})}),e.jsx(Ke,{className:"border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 p-4",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[(a.brands.length>0||a.categories.length>0||a.availability.length>0||a.rating>0||a.discount>0||a.searchQuery)&&e.jsx(A,{variant:"ghost",size:"sm",onClick:P,className:"self-start text-muted-foreground hover:text-foreground",children:"Clear all filters"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(oe,{asChild:!0,children:e.jsx(A,{variant:"outline",className:"flex-1",size:"lg",children:"Cancel"})}),e.jsx(oe,{asChild:!0,children:e.jsxs(A,{className:"flex-1",size:"lg",onClick:()=>S(!1),children:["Show ",N.length," Products"]})})]})]})})]})]})}),e.jsx(ja,{filters:a,onRemoveFilter:D,onClearAll:P}),e.jsx("div",{className:"flex items-center justify-between mb-6 mt-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Products (",N.length,")"]}),t.get("tag")&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Filtered by tag: ",e.jsx("span",{className:"font-medium",children:t.get("tag")})]})]})}),e.jsx(Je,{products:N,onAddToCart:V,isLoading:o}),N.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"No products found matching your filters."}),e.jsx(A,{variant:"outline",onClick:P,className:"mt-4 bg-transparent",children:"Clear All Filters"})]})]})]})}),e.jsx(Ye,{})]})}const Da=()=>e.jsx(Xe,{children:e.jsx(qe,{children:e.jsx(wa,{})})});export{Da as default};
