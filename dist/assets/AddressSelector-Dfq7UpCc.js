import{x as D,y as S,z as E,A as F,w as v,D as L,v as k,r as M,R as q,j as e,d as o,e as u,f as h,s as j,h as N,E as g,B as c,L as f,P as b,F as z,G as B,H as P,J as R,K as A,N as G}from"./index-DA0rZHy4.js";const Q={createOrder:r=>D("/snf-orders",r)},H=()=>{const r=S(),{data:l=[],isLoading:d,isError:i,error:t,refetch:p}=E({queryKey:["addresses"],queryFn:async()=>await k("/delivery-addresses")}),x=F({mutationFn:async a=>await L(`/delivery-addresses/${a}/set-default`,{}),onSuccess:()=>{r.invalidateQueries({queryKey:["addresses"]}),v.success("Default address updated")},onError:a=>v.error((a==null?void 0:a.message)||"Failed to set default")}),n=l.find(a=>a.isDefault);return{addresses:l,defaultAddress:n,isLoading:d,isError:i,error:t,refetch:p,setDefaultAddress:x.mutate,isSettingDefault:x.isPending}},O=({selectedAddressId:r,onAddressSelect:l,onEditAddress:d})=>{const{addresses:i,defaultAddress:t,isLoading:p,isError:x,error:n}=H(),[a,y]=M.useState(r||(t==null?void 0:t.id)||"");q.useEffect(()=>{!r&&t&&!a&&(y(t.id),l(t))},[t,r,a,l]);const C=s=>{const m=i.find(w=>w.id===s);m&&(y(s),l(m))};return p?e.jsxs(o,{children:[e.jsx(u,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"size-4"}),"Delivery Address"]})}),e.jsx(N,{className:"space-y-3",children:[...Array(2)].map((s,m)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{className:"h-4 w-2/3"}),e.jsx(g,{className:"h-3 w-1/2"}),e.jsx(g,{className:"h-3 w-5/6"})]},m))})]}):x?e.jsxs(o,{className:"border-red-200",children:[e.jsx(u,{children:e.jsxs(h,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(j,{className:"size-4"}),"Address Error"]})}),e.jsxs(N,{children:[e.jsx("p",{className:"text-sm text-red-600 mb-3",children:(n==null?void 0:n.message)||"Failed to load addresses"}),e.jsx(c,{asChild:!0,variant:"outline",size:"sm",children:e.jsx(f,{to:"/snf/address",children:"Manage Addresses"})})]})]}):!i||i.length===0?e.jsxs(o,{className:"border-yellow-200",children:[e.jsx(u,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"size-4"}),"No Addresses Found"]})}),e.jsxs(N,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"You need to add a delivery address to place an order."}),e.jsx(c,{asChild:!0,size:"sm",children:e.jsxs(f,{to:"/snf/address",children:[e.jsx(b,{className:"size-4 mr-2"}),"Add Address"]})})]})]}):e.jsxs(o,{children:[e.jsx(u,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"size-4"}),"Select Delivery Address"]}),e.jsx(c,{asChild:!0,variant:"outline",size:"sm",children:e.jsxs(f,{to:"/snf/address",children:[e.jsx(z,{className:"size-4 mr-2"}),"Manage"]})})]})}),e.jsxs(N,{children:[e.jsx(B,{value:a,onValueChange:C,className:"space-y-3",children:i.map(s=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(P,{value:s.id,id:s.id,className:"mt-1"}),e.jsx(R,{htmlFor:s.id,className:"flex-1 cursor-pointer",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.recipientName}),s.label&&e.jsx(A,{variant:"secondary",className:"text-xs",children:s.label}),s.isDefault&&e.jsxs(A,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200 text-xs",children:[e.jsx(G,{className:"h-3 w-3 mr-1"}),"Default"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.plotBuilding,s.plotBuilding&&s.streetArea?", ":"",s.streetArea]}),s.landmark&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Landmark: ",s.landmark]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.city,", ",s.state," - ",s.pincode]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Mobile: ",s.mobile]})]})}),d&&e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>d(s),className:"mt-1",children:e.jsx(z,{className:"size-4"})})]},s.id))}),e.jsx("div",{className:"mt-4 pt-3 border-t",children:e.jsx(c,{asChild:!0,variant:"outline",size:"sm",className:"w-full",children:e.jsxs(f,{to:"/snf/address",children:[e.jsx(b,{className:"size-4 mr-2"}),"Add New Address"]})})})]})]})};export{O as A,Q as s};
