import{R as S,j as e,r as d,c as U,b as M,B as T,I as B}from"./index-zuT5ggOt.js";import{a as q,b as R,u as V,H as _,p as z,F as W}from"./Footer-C4BwD6fd.js";import{P as G}from"./ProductGrid-gzIfGf7k.js";import"./ProductCard-DRZLjKRg.js";const Q=()=>{const p=[{title:"Fresh groceries, delivered to your door",description:"Handpicked fruits, crisp vegetables, dairy, and daily essentials. Fast delivery, great prices, and quality you can trust.",primaryLabel:"Shop now",primaryHref:"#products",secondaryLabel:"View deals",secondaryHref:"#deals",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?q=80&w=1200&auto=format&fit=crop",alt:"Fresh produce assortment including fruits and vegetables",badge:"Up to 30% off today"},{title:"Daily essentials, right when you need them",description:"Milk, bread, eggs, snacks, and more — delivered fast with freshness guaranteed.",primaryLabel:"Browse essentials",primaryHref:"#essentials",secondaryLabel:"Today’s offers",secondaryHref:"#offers",image:"https://images.unsplash.com/photo-1506806732259-39c2d0268443?q=80&w=1200&auto=format&fit=crop",alt:"Assorted vegetables and herbs on a table",badge:"Fresh arrivals daily",imageOnly:!0},{title:"Quality you can trust",description:"Locally sourced produce and top brands — curated for your kitchen.",primaryLabel:"Explore categories",primaryHref:"#categories",secondaryLabel:"Best sellers",secondaryHref:"#bestsellers",image:"https://images.unsplash.com/photo-1511690656952-34342bb7c2f2?q=80&w=1200&auto=format&fit=crop",alt:"Grocery basket with assorted products",badge:"Top picks this week",imageOnly:!0}],[h,g]=S.useState(0),x=S.useRef(null),v=()=>{typeof window<"u"&&x.current!==null&&(window.clearInterval(x.current),x.current=null)},y=()=>{typeof window>"u"||(v(),x.current=window.setInterval(()=>{g(o=>(o+1)%p.length)},5e3))};S.useEffect(()=>(y(),v),[]);const w=()=>g(o=>(o-1+p.length)%p.length),b=()=>g(o=>(o+1)%p.length);return e.jsx("section",{className:"relative bg-gradient-to-br from-green-600 via-green-500 to-emerald-500 text-white",children:e.jsx("div",{className:"w-screen relative left-1/2 right-1/2 -ml-[50vw] -mr-[50vw] p-0",children:e.jsxs("div",{className:"relative overflow-hidden h-[22rem] sm:h-[26rem] md:h-[30rem] lg:h-[36rem] group",onMouseEnter:v,onMouseLeave:y,role:"region","aria-roledescription":"carousel","aria-label":"Hero promotions",children:[p.map((o,c)=>e.jsx("div",{className:`absolute inset-0 transition-all duration-700 ease-in-out transform ${c===h?"opacity-100 translate-x-0":"opacity-0 translate-x-6 pointer-events-none"}`,"aria-hidden":c!==h,children:o.imageOnly?e.jsx("img",{className:"w-full h-full object-cover",src:o.image,alt:o.alt,loading:c===h?"eager":"lazy",decoding:"async"}):e.jsxs("div",{className:"p-4 grid md:grid-cols-2 gap-8 items-center h-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-extrabold tracking-tight leading-tight",children:o.title}),e.jsx("p",{className:"mt-4 text-white/90 text-base md:text-lg",children:o.description}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[e.jsx("a",{href:o.primaryHref,className:"inline-flex items-center justify-center rounded-md bg-white text-green-700 font-medium h-10 px-6 shadow hover:shadow-md transition","aria-label":o.primaryLabel,children:o.primaryLabel}),e.jsx("a",{href:o.secondaryHref,className:"inline-flex items-center justify-center rounded-md border border-white/80 text-white font-medium h-10 px-6 hover:bg-white/10 transition","aria-label":o.secondaryLabel,children:o.secondaryLabel})]})]}),e.jsxs("div",{className:"relative h-full",children:[e.jsx("img",{className:"w-full h-full max-w-2xl max-h-2xl object-cover rounded-lg shadow-lg",src:o.image,alt:o.alt,loading:c===h?"eager":"lazy",decoding:"async"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 bg-white/90 text-green-700 px-4 py-2 rounded shadow md:text-lg font-semibold",children:o.badge})]})]})},o.title)),e.jsx("button",{type:"button","aria-label":"Previous slide",onClick:w,className:"hidden sm:flex absolute inset-y-0 left-2 z-10 items-center justify-center w-10 text-white/90 hover:text-white transition-opacity opacity-0 group-hover:opacity-100 focus:opacity-100",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M15 6l-6 6 6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("button",{type:"button","aria-label":"Next slide",onClick:b,className:"hidden sm:flex absolute inset-y-0 right-2 z-10 items-center justify-center w-10 text-white/90 hover:text-white transition-opacity opacity-0 group-hover:opacity-100 focus:opacity-100",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex items-center gap-2 z-10",children:p.map((o,c)=>e.jsx("button",{type:"button","aria-label":`Go to slide ${c+1}`,onClick:()=>g(c),"aria-current":c===h,className:`h-2.5 w-2.5 rounded-full transition-all ${c===h?"bg-white":"bg-white/50 hover:bg-white/70"}`},c))})]})})})},J=()=>{const[p,h]=d.useState(""),[g,x]=d.useState([]),[v]=d.useState("relevance"),[y,w]=d.useState(null),b=U(),o=M(),[c,P]=d.useState([]),[F,N]=d.useState(!1),[$,C]=d.useState(null),{state:n,actions:I}=q(),{addItem:E,state:H}=R(),{currentDepotId:j}=V(),L=n.products.map(t=>{const a=n.depotVariants.filter(m=>m.productId===t.id),s=a.filter(m=>!m.notInStock&&!m.isHidden),r=s.map(m=>{const f=m.buyOncePrice||m.mrp||0;return typeof f=="number"&&isFinite(f)&&f>0?f:0}).filter(m=>m>0),i=r.length>0?Math.min(...r):0,l=s.length>0,u=s.map(m=>{const f=m.mrp||0;return typeof f=="number"&&isFinite(f)&&f>0?f:0}).filter(m=>m>0),k=u.length>0?Math.max(...u):0;return{product:t,variants:a,buyOncePrice:i,mrp:k,inStock:l,deliveryTime:"Same day delivery"}}),D=n.isLoading;d.useEffect(()=>{(async()=>{N(!0),C(null);try{const a=await z.getCategories(),r=[...(Array.isArray(a)?a:[]).map(i=>({id:String(i.id??i._id??i.slug??""),name:i.name||i.title||"Category",imageUrl:i.imageUrl||i.attachmentUrl||i.iconUrl||i.url||void 0}))].sort((i,l)=>{const u=typeof i.name=="string"&&i.name.toLowerCase().includes("milk")?1:0,k=typeof l.name=="string"&&l.name.toLowerCase().includes("milk")?1:0;return u!==k?k-u:(i.name||"").localeCompare(l.name||"")});P(r)}catch(a){C((a==null?void 0:a.message)||"Failed to load categories")}finally{N(!1)}})()},[]),d.useEffect(()=>{(async()=>{if(j&&(!n.currentDepot||n.currentDepot.id!==j))try{const a={id:j,name:`Depot ${j}`,address:"",pincode:"",isActive:!0};await I.setDepot(a)}catch(a){console.error("Failed to load products for depot:",a)}})()},[j,n.currentDepot,I]),d.useEffect(()=>{!n.userLocation&&n.isLoading},[n.userLocation,n.isLoading]),d.useEffect(()=>{n.currentDepot&&(console.log(`Products loaded for depot: ${n.currentDepot.name} (${n.currentDepot.id})`),console.log(`Total products: ${n.products.length}, Total variants: ${n.depotVariants.length}`))},[n.currentDepot,n.products.length,n.depotVariants.length]),d.useEffect(()=>{const t=(b.hash||"").replace("#","");if(!t)return;if(t.startsWith("category-")){const r=t.slice(9),i=parseInt(r,10);Number.isFinite(i)&&x([i])}const a=()=>{const r=document.getElementById(t);r&&r.scrollIntoView({behavior:"smooth",block:"start"})};a();const s=setTimeout(a,150);return()=>clearTimeout(s)},[b.hash,F,c.length]),d.useEffect(()=>{const a=new URLSearchParams(b.search||"").get("tag");if(!a){w(null);return}const s=a.toLowerCase().trim();if(s.startsWith("category:")){const l=s.split(":")[1],u=parseInt(l||"",10);Number.isFinite(u)&&x([u]),w(null)}else w(s);const r=()=>{const l=document.getElementById("products");l&&l.scrollIntoView({behavior:"smooth",block:"start"})};r();const i=setTimeout(r,120);return()=>clearTimeout(i)},[b.search]);const O=d.useMemo(()=>{let t=L;if(p.trim()){const s=p.trim().toLowerCase();t=t.filter(r=>r.product.name.toLowerCase().includes(s)||(r.product.description?r.product.description.toLowerCase().includes(s):!1))}if(g.length>0&&(t=t.filter(s=>g.includes(s.product.categoryId||0))),y)if(y==="non-dairy")t=t.filter(s=>!s.product.isDairyProduct);else if(y==="contains-dairy")t=t.filter(s=>!!s.product.isDairyProduct);else{const s=y.toLowerCase().trim();t=t.filter(r=>{const i=r.product.tags;if(!i)return!1;const l=i.split(",").map(u=>u.trim().toLowerCase()).filter(Boolean);return s==="pasteurized"||s==="pasturized"?l.includes("pasteurized")||l.includes("pasturized"):l.includes(s)})}const a=[...t];switch(v){case"price_asc":a.sort((s,r)=>s.buyOncePrice-r.buyOncePrice);break;case"price_desc":a.sort((s,r)=>r.buyOncePrice-s.buyOncePrice);break;case"popularity_desc":a.sort((s,r)=>(r.product.id||0)-(s.product.id||0));break;case"relevance":default:a.sort((s,r)=>s.buyOncePrice!==r.buyOncePrice?s.buyOncePrice-r.buyOncePrice:(s.product.id||0)-(r.product.id||0));break}return a},[L,p,g,v,y]),A=(t,a,s)=>{a&&E(t,a,s||1)};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[e.jsx(_,{cartCount:H.items.reduce((t,a)=>t+a.quantity,0),onSearch:h}),e.jsxs("main",{className:"flex-1",children:[e.jsx(Q,{}),e.jsxs("section",{className:"container mx-auto px-4 md:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-semibold",children:"Browse by Category"}),$&&e.jsx(T,{size:"sm",variant:"outline",onClick:()=>{N(!0),z.getCategories().then(t=>{const s=[...(Array.isArray(t)?t:[]).map(r=>({id:String(r.id??r._id??r.slug??""),name:r.name||r.title||"Category",imageUrl:r.imageUrl||r.attachmentUrl||r.iconUrl||r.url||void 0}))].sort((r,i)=>{const l=typeof r.name=="string"&&r.name.toLowerCase().includes("milk")?1:0,u=typeof i.name=="string"&&i.name.toLowerCase().includes("milk")?1:0;return l!==u?u-l:(r.name||"").localeCompare(i.name||"")});P(s),C(null)}).catch(t=>C((t==null?void 0:t.message)||"Failed to load categories")).finally(()=>N(!1))},children:"Retry"})]}),F?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:Array.from({length:12}).map((t,a)=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"aspect-square w-full rounded-lg bg-muted/30"}),e.jsx("div",{className:"h-3 w-2/3 bg-muted/40 rounded mt-3"})]},a))}):e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs("button",{id:"category-all",type:"button",onClick:()=>{x([]),w(null);const t=new URLSearchParams(b.search||"");t.delete("tag"),o({search:t.toString()?`?${t.toString()}`:""},{replace:!0})},className:"group text-left","aria-label":"Show all products",children:[e.jsx("div",{className:`relative aspect-square w-full overflow-hidden rounded-full border bg-accent/10 ${g.length===0?"ring-2 ring-primary border-primary":""}`,children:e.jsx("div",{className:"h-full w-full grid place-items-center text-muted-foreground bg-gradient-to-br from-muted/30 to-transparent rounded-full",children:"All"})}),e.jsx("div",{className:"mt-3 text-center",children:e.jsx("p",{className:`text-sm font-medium line-clamp-2 transition-colors ${g.length===0?"text-primary":"group-hover:text-primary"}`,children:"All"})})]},"all"),c.map(t=>{var r;const a=parseInt(t.id,10),s=g.includes(a);return e.jsxs("a",{id:`category-${a}`,href:`/snf/category/${a}`,className:"group text-left","aria-label":`Filter by category ${t.name}`,children:[e.jsx("div",{className:`relative aspect-square w-full overflow-hidden rounded-full border bg-accent/10 ${s?"ring-2 ring-primary border-primary":""}`,children:t.imageUrl?e.jsx("img",{src:`http://localhost:3006${t.imageUrl}`,alt:t.name,className:" h-full w-full  object-cover rounded-full transition-transform duration-300 group-hover:scale-[1.03]",loading:"lazy"}):e.jsx("div",{className:"h-full w-full grid place-items-center text-muted-foreground bg-gradient-to-br from-muted/30 to-transparent rounded-full",children:((r=t.name)==null?void 0:r.charAt(0))||"C"})}),e.jsx("div",{className:"mt-3 text-center",children:e.jsx("p",{className:`text-sm font-medium line-clamp-2 transition-colors ${s?"text-primary":"group-hover:text-primary"}`,children:t.name})})]},t.id)}),c.length===0&&!$&&e.jsx("p",{className:"col-span-2 sm:col-span-3 lg:col-span-6 text-muted-foreground",children:"No categories available."})]})]}),e.jsxs("section",{className:"container mx-auto px-4 md:px-6 lg:px-8",children:[e.jsx("div",{className:"h-px w-full bg-border/60"}),e.jsx("div",{className:"flex items-end justify-between py-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl md:text-2xl font-semibold",children:"Products"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click a category above to filter products below"})]})})]}),e.jsxs("section",{id:"products",className:"container mx-auto px-3 sm:px-4 md:px-6 lg:px-8 py-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx(B,{value:p,onChange:t=>h(t.target.value),placeholder:"Search products","aria-label":"Search products"})}),D&&L.length===0?e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:Array.from({length:8}).map((t,a)=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"aspect-[4/3] w-full rounded-lg bg-muted/30"}),e.jsx("div",{className:"h-3 w-3/4 bg-muted/40 rounded mt-3"})]},a))})}):e.jsx("div",{className:"",children:e.jsx(G,{products:O,onAddToCart:A,isLoading:D})})]})]}),e.jsx(W,{})]})},ee=()=>e.jsx(J,{});export{ee as default};
