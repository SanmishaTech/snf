import{n as k,r as c,o as F,q as P,j as e,B as l,P as j,d as p,i as N,v as o,A as f,H as E,F as q,E as B,G as H,J as M,K as Q,N as z,O as K,Q as O,t as g,s as I,m as L}from"./index-DbdoOQ-I.js";import{b as _,H as G,F as J,P as R,C as T}from"./Footer-CQgf06Py.js";const W=()=>{const{state:v}=_(),m=k(),[y,t]=c.useState(!1),[a,x]=c.useState(null),[u,w]=c.useState(null),{data:i,isLoading:C,isError:A,error:r}=F({queryKey:["addresses"],queryFn:async()=>await L("/delivery-addresses")}),n=P({mutationFn:async s=>await I(`/delivery-addresses/${s}/set-default`,{}),onSuccess:()=>{m.invalidateQueries({queryKey:["addresses"]}),g.success("Default address updated")},onError:s=>g.error((s==null?void 0:s.message)||"Failed to set default")}),h=()=>{x(null),t(!0)},b=s=>{x(s),t(!0)},S=()=>{m.invalidateQueries({queryKey:["addresses"]}),t(!1)},D=s=>{};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[e.jsx(G,{cartCount:v.items.reduce((s,d)=>s+d.quantity,0),onSearch:D}),e.jsx("main",{className:"flex-1",children:e.jsxs("section",{className:"container mx-auto px-4 md:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"Manage Delivery Addresses"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, edit, and set your default delivery address"})]}),e.jsxs(l,{size:"sm",onClick:h,children:[e.jsx(j,{className:"h-4 w-4 mr-2"})," Add New Address"]})]}),C?e.jsx("div",{className:"space-y-3",children:[...Array(3)].map((s,d)=>e.jsx(p,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"h-4 w-2/3"}),e.jsx(o,{className:"h-3 w-1/2"}),e.jsx(o,{className:"h-3 w-5/6"})]})})},d))}):A?e.jsx("div",{className:"p-4 text-destructive text-sm",children:(r==null?void 0:r.message)||"Failed to load addresses"}):e.jsxs("div",{className:"space-y-3",children:[i&&i.length>0?i.map(s=>e.jsx(p,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium",children:s.recipientName}),s.label&&e.jsx(f,{variant:"secondary",children:s.label}),s.isDefault&&e.jsxs(f,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(E,{className:"h-3 w-3 mr-1"})," Default"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.plotBuilding,s.plotBuilding&&s.streetArea?", ":"",s.streetArea]}),!!s.landmark&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Landmark: ",s.landmark]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.city,", ",s.state," - ",s.pincode]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Mobile: ",s.mobile]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[!s.isDefault&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{w(s.id),n.mutate(s.id)},disabled:n.isPending&&u===s.id,children:[n.isPending&&u===s.id?e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(B,{className:"h-4 w-4 mr-2"}),"Set Default"]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>b(s),children:[e.jsx(H,{className:"h-4 w-4 mr-2"})," Edit"]})]})]})})},s.id)):e.jsx("div",{className:"p-6 text-sm text-muted-foreground border rounded-md",children:"You have no saved addresses yet."}),e.jsx("div",{className:"pt-2",children:e.jsxs(l,{size:"sm",onClick:h,children:[e.jsx(j,{className:"h-4 w-4 mr-2"})," Add New Address"]})})]})]})}),e.jsx(J,{}),e.jsx(M,{open:y,onOpenChange:t,children:e.jsxs(Q,{className:"sm:max-w-[620px]",children:[e.jsx(z,{children:e.jsx(K,{children:a?"Edit Address":"Add New Address"})}),e.jsx("div",{className:"py-2",children:e.jsx(O,{mode:a?"edit":"create",addressId:a==null?void 0:a.id,initialData:a||void 0,onSuccess:()=>S()})})]})})]})},U=()=>e.jsx(R,{children:e.jsx(T,{children:e.jsx(W,{})})});export{U as default};
