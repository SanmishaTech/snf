import{r as i,j as e,B as A,u as V,a as ee,b as te,L as Q,C as se,I as re}from"./index-DQg35Iz_.js";import{p as q,u as ne,a as ae,H as ie,F as oe,P as ce,C as le}from"./Footer-bNVHIytO.js";const de=(n,o)=>{const[c,d]=i.useState(null),[l,m]=i.useState(null),[t,x]=i.useState(!1),u=i.useCallback(async()=>{if(!(!n||!o)){x(!0),m(null);try{const[p,v]=await Promise.all([q.getProductById(n),q.getProductVariants(n,o)]);if(!p)throw{type:"API_ERROR",message:"Product not found",code:"PRODUCT_NOT_FOUND",recoverable:!1};console.log("Product data fetched:",p),console.log("Variants data fetched:",v);const g=v.reduce((r,C)=>{if(!r)return C;const I=r.buyOncePrice??r.mrp;return(C.buyOncePrice??C.mrp)<I?C:r},null),S=(g==null?void 0:g.buyOncePrice)??(g==null?void 0:g.mrp),$=(g==null?void 0:g.mrp)??0;let h=0;S&&S<$&&(h=($-S)/$);const w={product:p,variants:v,buyOncePrice:S||0,mrp:$,discount:h>0?h:void 0,inStock:v.some(r=>!r.notInStock&&r.closingQty>0),deliveryTime:v.some(r=>!r.notInStock&&r.closingQty>0)?"Same day delivery":"Out of stock"};d(w)}catch(p){m(p)}finally{x(!1)}}},[n,o]);return i.useEffect(()=>{n&&o&&u()},[n,o,u]),{product:c,error:l,isLoading:t,refresh:u}},F=({loading:n,disabled:o,fullWidth:c,iconLeft:d,iconRight:l,className:m="",sizeVariant:t="md",children:x,...u})=>{const p=t==="sm"?"h-9 px-3 text-sm":t==="lg"?"h-12 px-6 text-base":"h-10 px-4 text-sm",v=c?"w-full":"";return e.jsxs(A,{className:`${p} ${v} inline-flex items-center justify-center gap-2 ${m}`,disabled:o||n,"aria-disabled":o||n||void 0,"aria-busy":n||void 0,...u,children:[n&&e.jsx("span",{className:"inline-block size-4 rounded-full border-2 border-current border-t-transparent animate-spin","aria-hidden":"true"}),d&&e.jsx("span",{"aria-hidden":"true",children:d}),e.jsx("span",{children:x}),l&&e.jsx("span",{"aria-hidden":"true",children:l})]})},ue=n=>{const o=`https://www.indraai.in${n}`,c=d=>`${o}${o.includes("?")?"&":"?"}w=${d}`;return[{src:c(1200),alt:"Product image"},{src:c(800),alt:"Product image alt"},{src:c(600),alt:"Product close-up"}]},me=()=>{var B;const{id:n}=V(),[o]=ee(),c=te(),d=i.useRef(null),{state:l}=ne(),m=(B=l.currentDepot)==null?void 0:B.id,{product:t,error:x,isLoading:u}=de(n?parseInt(n):void 0,m),[p,v]=i.useState(o.get("variant")?parseInt(o.get("variant")):null),[g,S]=i.useState(1),$=i.useRef(null),h=i.useRef(null),{addItem:w}=ae(),r=i.useMemo(()=>t?p?t.variants.find(s=>s.id===p):t.variants.find(s=>!s.notInStock&&!s.isHidden)||t.variants[0]:null,[p,t]),C=r&&(r.buyOncePrice||r.mrp)||0,I=(r==null?void 0:r.mrp)||0,R=I>C?(I-C)/I:0,U=i.useMemo(()=>t?ue(t.product.attachmentUrl||""):[],[t]),M=i.useMemo(()=>{var N;if(!t)return[];const s=new Set;if(t.product.tags){const y=t.product.tags.split(",").map(a=>a.trim()).filter(a=>a.length>0),b=y.some(a=>{const k=a.toLowerCase();return k.includes("dairy")||k.includes("vegan")||k.includes("vegetarian")||k.includes("pasteurized")||k.includes("organic")||k.includes("fresh")});y.forEach(a=>{a.toLowerCase()==="milk"&&b||s.add(a)})}return(N=t.product.category)!=null&&N.name&&!s.has(t.product.category.name)&&s.add(t.product.category.name),Array.from(s).some(y=>{const b=y.toLowerCase();return b.includes("dairy")||b.includes("vegan")||b.includes("vegetarian")||b.includes("pasteurized")||b==="milk"})||(t.product.isDairyProduct?s.add("Contains Dairy"):s.add("Non-Dairy")),Array.from(s)},[t]),W=i.useMemo(()=>{if(!t)return"";const s=t.product.attachmentUrl||"";return s?`https://www.indraai.in${s}`:"https://images.unsplash.com/photo-1546470427-0fd2788c37e3?auto=format&fit=crop&w=400&q=80"},[t]);i.useEffect(()=>{var s;!u&&(t||x)&&((s=d.current)==null||s.focus())},[u,t,x]),i.useEffect(()=>{if(t&&!p){const s=t.variants.find(f=>!f.notInStock&&!f.isHidden);s&&v(s.id)}},[t,p]);const T=s=>{if(!(!t||!r)){try{w(t,r,g)}catch{}try{const f=document.getElementById("snf-cart-button");if(!s||!f)return;const P=s.style.transform,N=s.style.transition;s.style.transition=`${N?N+", ":""}transform 120ms ease`,s.style.transform="scale(0.97)",setTimeout(()=>{s.style.transform=P,s.style.transition=N},140);const y=s.getBoundingClientRect(),b=f.getBoundingClientRect(),a=document.createElement("img");a.src=W||"",a.setAttribute("aria-hidden","true");const k=56;a.style.position="fixed",a.style.left=`${y.left+y.width/2-k/2}px`,a.style.top=`${y.top+y.height/2-k/2}px`,a.style.width=`${k}px`,a.style.height=`${k}px`,a.style.objectFit="cover",a.style.zIndex="9999",a.style.borderRadius="8px",a.style.pointerEvents="none",a.style.boxShadow="0 4px 12px rgba(0,0,0,0.2)",document.body.appendChild(a);const O=b.left+b.width/2-(y.left+y.width/2),z=b.top+b.height/2-(y.top+y.height/2),_=O*.2,G=z*.2-20;a.style.transition="transform 180ms ease-out, opacity 180ms ease-out",a.style.transform="translate(0px, 0px) scale(0.9)",a.style.opacity="0.9",requestAnimationFrame(()=>{a.style.transform=`translate(${_}px, ${G}px) scale(1.02)`});const D=Y=>{if(Y.propertyName!=="transform")return;a.removeEventListener("transitionend",D),a.style.transition="transform 520ms cubic-bezier(0.22, 1, 0.36, 1), opacity 520ms ease",a.style.transform=`translate(${O}px, ${z}px) scale(0.4) rotate(8deg)`,a.style.opacity="0.25";const L=Z=>{if(Z.propertyName!=="transform")return;a.removeEventListener("transitionend",L);const X=getComputedStyle(f).color,j=document.createElement("span"),J=b.left+b.width/2,K=b.top+b.height/2,E=14;j.style.position="fixed",j.style.left=`${J-E}px`,j.style.top=`${K-E}px`,j.style.width=`${E*2}px`,j.style.height=`${E*2}px`,j.style.border=`2px solid ${X}`,j.style.borderRadius="9999px",j.style.opacity="0.5",j.style.pointerEvents="none",j.style.zIndex="9999",j.style.transform="scale(0.4)",j.style.transition="transform 420ms ease, opacity 420ms ease",document.body.appendChild(j),requestAnimationFrame(()=>{j.style.transform="scale(1.8)",j.style.opacity="0"}),setTimeout(()=>j.remove(),460),a&&a.parentNode&&a.parentNode.removeChild(a)};a.addEventListener("transitionend",L)};a.addEventListener("transitionend",D)}catch{}}},H=e.jsx("nav",{className:"text-sm text-muted-foreground mb-3","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"flex items-center gap-1",children:[e.jsx("li",{children:e.jsx(Q,{to:"/snf",className:"hover:underline",children:"Home"})}),e.jsx("li",{"aria-hidden":"true",children:"/"}),e.jsx("li",{children:e.jsx("a",{href:"/snf#products",className:"hover:underline",children:"Products"})}),t!=null&&t.product.categoryId?e.jsxs(e.Fragment,{children:[e.jsx("li",{"aria-hidden":"true",children:"/"}),e.jsx("li",{children:e.jsx("a",{href:`/snf#category-${t.product.categoryId}`,className:"hover:underline capitalize",children:"Category"})})]}):null]})});return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("a",{href:"#snf-main",className:"sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:z-50 focus:bg-background focus:text-foreground focus:ring-2 focus:ring-ring px-3 py-2 rounded",children:"Skip to content"}),e.jsx("header",{role:"banner",className:"sticky top-0 z-40 bg-background/80 backdrop-blur border-b",children:e.jsx(ie,{cartCount:0,onSearch:()=>{}})}),e.jsxs("main",{id:"snf-main",role:"main",className:"container mx-auto px-4 md:px-6 lg:px-8 py-4",children:[H,e.jsx("h1",{ref:d,tabIndex:-1,className:"sr-only",children:"Product details"}),u&&e.jsx(ye,{}),x&&e.jsxs("div",{className:"border rounded-md p-6 text-center",children:[e.jsx("p",{className:"text-lg font-semibold mb-2",children:"Unable to load product"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:x.message||"Unknown error"}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(F,{onClick:()=>c(0),"aria-label":"Retry loading product",children:"Retry"}),e.jsx(F,{variant:"outline",onClick:()=>c("/snf"),"aria-label":"Back to listing",children:"Back to listing"})]})]}),!u&&t&&e.jsxs(e.Fragment,{children:[e.jsxs("article",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("section",{"aria-label":"Product image gallery",children:e.jsx(fe,{gallery:U,title:t.product.name,tags:M,tagHref:s=>{var y;const f=(y=t.product.category)==null?void 0:y.name,P=t.product.categoryId;if(f&&s===f&&P)return`/snf?tag=category:${P}`;const N=s.trim().toLowerCase();return N==="non-dairy"?"/snf?tag=non-dairy":N==="contains dairy"?"/snf?tag=contains-dairy":`/snf?tag=${encodeURIComponent(N)}`}})}),e.jsxs("section",{"aria-label":"Product summary",className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-semibold",children:t.product.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-2xl font-bold",children:["₹",C.toFixed(2)]}),R>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm text-muted-foreground line-through",children:["₹",I.toFixed(2)]}),e.jsxs("span",{className:"bg-destructive/10 text-destructive px-2 py-1 rounded text-sm font-medium",children:[Math.round(R*100),"% OFF"]})]})]}),t.variants.length>1&&e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Select Variant"}),e.jsx("div",{role:"radiogroup","aria-label":"Select Variant",className:"grid grid-cols-3 sm:grid-cols-4 gap-2",children:t.variants.map(s=>{const f=s.id===(r==null?void 0:r.id),P=!s.notInStock&&!s.isHidden,N=s.closingQty!==void 0&&s.closingQty>0&&s.closingQty<=10;return e.jsxs("button",{role:"radio","aria-checked":f,disabled:!P,onClick:()=>v(s.id),title:`${s.name}${N?` • Only ${s.closingQty} left`:""}`,className:`relative h-10 min-w-[3rem] inline-flex items-center justify-center rounded-md border px-2 text-xs font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring hover:bg-accent ${f?"ring-2 ring-primary border-primary bg-accent":"bg-background"} ${P?"":"opacity-50 cursor-not-allowed line-through"}`,children:[e.jsx("span",{className:"truncate max-w-[6rem]",children:s.name}),f&&e.jsx(se,{className:"absolute -top-1 -right-1 h-4 w-4 text-primary bg-background rounded-full"}),!P&&e.jsx("span",{className:"absolute bottom-1 text-[10px] text-muted-foreground",children:"Out"}),N&&P&&e.jsx("span",{className:"absolute top-0.5 right-0.5 text-[10px] text-orange-600",children:"Low"})]},s.id)})})]}),e.jsx("div",{className:"flex items-center gap-3 text-sm",children:r&&!r.notInStock?e.jsx(e.Fragment,{children:e.jsx("span",{className:"text-green-600 font-medium",children:"✓ In Stock"})}):e.jsx("span",{className:"text-red-600 font-medium",children:!1})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"qty",className:"text-sm font-medium",children:"Quantity"}),e.jsxs("div",{className:"inline-flex items-center rounded border ml-5",children:[e.jsx(A,{onClick:()=>S(s=>Math.max(1,s-1)),variant:"ghost",className:"px-3 py-2 hover:bg-accent transition-colors","aria-label":"Decrease quantity",children:"-"}),e.jsx(re,{id:"qty",type:"number",className:"[&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [appearance:textfield] w-16 text-center bg-transparent outline-none border-none",value:g,onChange:s=>S(Math.max(1,Number(s.target.value)||1)),min:"1",max:(r==null?void 0:r.closingQty)||99}),e.jsx(A,{onClick:()=>S(s=>s+1),variant:"ghost",className:"px-3 py-2 hover:bg-accent transition-colors","aria-label":"Increase quantity",children:"+"})]})]}),e.jsxs("ul",{className:"list-disc pl-5 text-sm space-y-1",children:[e.jsx("li",{children:"Quality checked and packed with care"}),e.jsx("li",{children:"Free delivery on qualifying orders"})]}),e.jsxs("div",{className:"prose prose-sm max-w-none dark:prose-invert",children:[e.jsx("h3",{children:"Description"}),e.jsx("div",{dangerouslySetInnerHTML:{__html:t.product.description||"No description available"}})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[e.jsx("div",{ref:$,className:"flex-1",children:e.jsx(F,{className:"w-full",disabled:!r||r.notInStock,"aria-label":`Add ${t.product.name} to cart`,fullWidth:!0,onClick:()=>$.current&&T($.current),children:r!=null&&r.notInStock?"Out of Stock":"Add to Cart"})}),e.jsx(F,{className:"flex-1 hover:bg-black",variant:"secondary",disabled:!r||r.notInStock,"aria-label":"Buy now",fullWidth:!0,children:"Buy Now"})]})]})]}),e.jsxs("section",{className:"mt-10 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsx(pe,{})}),e.jsxs("aside",{className:"lg:col-span-1 space-y-6",children:[e.jsx(he,{}),e.jsx(xe,{})]})]}),e.jsxs("section",{className:"mt-12",children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Related products"}),e.jsx(ge,{currentId:t.product.id})]})]})]}),!u&&t&&r&&e.jsx("div",{className:"sticky bottom-0 inset-x-0 bg-background border-t shadow-sm",children:e.jsxs("div",{className:"container mx-auto px-4 md:px-6 lg:px-8 py-3 flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:t.product.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.name," • ₹",C.toFixed(2)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{ref:h,children:e.jsx(F,{disabled:r.notInStock,"aria-label":`Add ${t.product.name} to cart (sticky)`,onClick:()=>h.current&&T(h.current),children:r.notInStock?"Out of Stock":"Add to Cart"})}),e.jsx(F,{className:"hover:bg-black",variant:"secondary",disabled:r.notInStock,"aria-label":"Buy now (sticky)",children:"Buy Now"})]})]})}),e.jsx("footer",{role:"contentinfo",className:"mt-10 border-t",children:e.jsx(oe,{})}),e.jsx(be,{product:t})]})},pe=()=>e.jsx("div",{className:"divide-y rounded-md border",children:[{title:"Features & Specs",content:"Farm fresh, handpicked quality. Nutritional values and storage tips included."},{title:"Materials/Care",content:"Keep refrigerated. Rinse before use. Store in a cool, dry place."},{title:"Size Guide",content:"Regular pack: 500g, Large: 1kg, Family: 2kg."},{title:"Shipping & Returns",content:"Fast delivery. Returns accepted within 3 days if unopened."},{title:"FAQs",content:"Q: Is it organic? A: Yes, sourced from trusted farms."}].map((n,o)=>e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"flex cursor-pointer items-center justify-between p-4 font-medium hover:bg-accent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[e.jsx("span",{children:n.title}),e.jsx("span",{"aria-hidden":"true",className:"transition-transform group-open:rotate-180",children:"⌄"})]}),e.jsx("div",{className:"p-4 text-sm text-muted-foreground",children:n.content})]},o))}),he=()=>e.jsxs("div",{className:"rounded-md border p-4 space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Why shop with SNF"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:"✓ Secure checkout"}),e.jsx("li",{children:"✓ Freshness guarantee"}),e.jsx("li",{children:"✓ Free delivery over ₹299"})]})]}),xe=()=>{const[n,o]=i.useState(""),[c,d]=i.useState(!1),[l,m]=i.useState(null);return e.jsxs("div",{className:"rounded-md border p-4 space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Delivery/Pickup Estimator"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:n,onChange:t=>o(t.target.value),className:"flex-1 rounded border px-3 py-2 bg-background",placeholder:"Enter ZIP","aria-label":"Enter ZIP code"}),e.jsx(F,{onClick:()=>{d(!0),setTimeout(()=>{m("Tomorrow, 10am - 12pm"),d(!1)},600)},loading:c,"aria-label":"Estimate delivery",children:"Check"})]}),l&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Estimated delivery: ",l]})]})},ge=({currentId:n})=>e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-4",children:e.jsx("div",{className:"col-span-full text-center text-muted-foreground py-8",children:"Related products will appear here"})}),fe=({gallery:n,title:o,tags:c=[],tagHref:d})=>{const[l,m]=i.useState(0),[t,x]=i.useState(null),[u,p]=i.useState(!1),[v,g]=i.useState(!0),S=n[l];i.useEffect(()=>{const h=requestAnimationFrame(()=>g(!0));return()=>cancelAnimationFrame(h)},[]);const $=h=>{h!==l&&(x(l),m(h),p(!1),g(!1),requestAnimationFrame(()=>{p(!0),g(!0)}),setTimeout(()=>{x(null),p(!1)},400))};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative rounded-md overflow-hidden border h-[360px] md:h-[420px]",children:[e.jsx("img",{src:S.src,alt:`${o} - image ${l+1}`,className:`absolute inset-0 w-full h-full object-cover transition-[opacity,transform] duration-300 ease-out cursor-zoom-in ${v?"opacity-100 scale-100":"opacity-0 scale-[1.02]"}`,width:1200,height:420,loading:"lazy",decoding:"async"},l),t!==null&&e.jsx("img",{src:n[t].src,alt:`${o} - previous image ${t+1}`,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-300 ease-out ${u?"opacity-0":"opacity-100"}`,width:1200,height:420,"aria-hidden":"true"},`prev-${t}`)]}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 gap-2",children:n.map((h,w)=>e.jsx("button",{onClick:()=>$(w),className:`relative h-16 rounded border overflow-hidden focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring ${w===l?"ring-2 ring-primary":""}`,"aria-label":`Show image ${w+1}`,children:e.jsx("img",{src:h.src,alt:`${o} thumbnail ${w+1}`,className:"w-full h-full object-cover",loading:"lazy",decoding:"async"})},`thumb-${w}`))}),c.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:c.map((h,w)=>e.jsx(Q,{to:d?d(h,w):"/snf#products",className:"px-2.5 py-1 rounded-full border text-xs bg-background hover:bg-accent transition-colors",children:h},`p-tag-${w}`))})]})},ye=()=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 animate-pulse",children:[e.jsx("div",{className:"h-[420px] bg-muted/40 rounded-md"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-6 bg-muted/40 rounded w-2/3"}),e.jsx("div",{className:"h-4 bg-muted/40 rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-muted/40 rounded w-1/2"}),e.jsx("div",{className:"h-24 bg-muted/40 rounded"}),e.jsx("div",{className:"h-10 bg-muted/40 rounded w-1/2"})]})]}),be=({product:n})=>(i.useEffect(()=>{const o=document.title,c=(n==null?void 0:n.product)||n;c&&(document.title=`${c.name||"Product"} | SNF`);let d=document.querySelector('link[rel="canonical"]');d||(d=document.createElement("link"),d.rel="canonical",document.head.appendChild(d)),d.href=window.location.href;const l=(t,x)=>{let u=document.querySelector(`meta[property="${t}"]`);u||(u=document.createElement("meta"),u.setAttribute("property",t),document.head.appendChild(u)),u.content=x};c&&(l("og:title",c.name||"Product"),l("og:type","product"),l("og:url",window.location.href),l("og:image",c.attachmentUrl?`${c.attachmentUrl}&w=1200`:""),l("og:description",c.description||""));let m=document.getElementById("snf-product-jsonld");if(m||(m=document.createElement("script"),m.id="snf-product-jsonld",m.type="application/ld+json",document.head.appendChild(m)),n){const t=(n==null?void 0:n.product)||n,x={"@context":"https://schema.org/","@type":"Product",name:(t==null?void 0:t.name)||"Product",image:t!=null&&t.attachmentUrl?[`${t.attachmentUrl}&w=1200`]:[],description:(t==null?void 0:t.description)||"",sku:`SNF-${(t==null?void 0:t.id)||1}`,aggregateRating:{"@type":"AggregateRating",ratingValue:4.5.toFixed(1),reviewCount:128},offers:{"@type":"Offer",priceCurrency:"INR",price:50 .toFixed(2),availability:"https://schema.org/InStock",url:window.location.href}};m.text=JSON.stringify(x)}return()=>{document.title=o}},[n]),null),Ne=()=>e.jsx(ce,{children:e.jsx(le,{children:e.jsx(me,{})})});export{Ne as default};
