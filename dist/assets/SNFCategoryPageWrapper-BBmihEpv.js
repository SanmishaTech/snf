import{r as g,U as Ne,j as e,V as Ce,W as Se,X as O,Y as Q,Z as H,_ as Pe,$ as le,a0 as Re,a1 as ke,a2 as Y,d as De,e as Me,f as Ae,a3 as W,A as I,B as D,i as Ee,z as B,a4 as $e,I as X,a5 as G,a6 as q,a7 as Z,a8 as J,a9 as oe,aa as V,a as Le,F as Fe,ab as Te,ac as Ie,ad as _e,ae as Be,af as ze,ag as Ve,ah as Oe,ai as ie}from"./index-Dox9eENA.js";import{u as Ke,H as He,F as Qe,p as Ue,P as Ye,C as Xe}from"./Footer-DpmipM7U.js";import{P as Ge}from"./ProductGrid-D1cm-KnE.js";import{a as qe}from"./useProducts-DgbfFU4g.js";import"./ProductCard-D5paY3aj.js";var de=["PageUp","PageDown"],ue=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],me={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},K="Slider",[ee,Ze,Je]=Se(K),[he,Pa]=Ce(K,[Je]),[We,U]=he(K),ge=g.forwardRef((a,t)=>{const{name:s,min:r=0,max:n=100,step:h=1,orientation:d="horizontal",disabled:u=!1,minStepsBetweenThumbs:b=0,defaultValue:w=[r],value:R,onValueChange:l=()=>{},onValueCommit:j=()=>{},inverted:i=!1,form:f,...v}=a,y=g.useRef(new Set),C=g.useRef(0),k=d==="horizontal"?ea:aa,[o=[],c]=Ne({prop:R,defaultProp:w,onChange:x=>{var p;(p=[...y.current][C.current])==null||p.focus(),l(x)}}),m=g.useRef(o);function N(x){const S=oa(o,x);A(x,S)}function M(x){A(x,C.current)}function L(){const x=m.current[C.current];o[C.current]!==x&&j(o)}function A(x,S,{commit:p}={commit:!1}){const E=da(h),F=ua(Math.round((x-r)/h)*h+r,E),_=le(F,[r,n]);c((T=[])=>{const P=ra(T,_,S);if(la(P,b*h)){C.current=P.indexOf(_);const z=String(P)!==String(T);return z&&p&&j(P),z?P:T}else return T})}return e.jsx(We,{scope:a.__scopeSlider,name:s,disabled:u,min:r,max:n,valueIndexToChangeRef:C,thumbs:y.current,values:o,orientation:d,form:f,children:e.jsx(ee.Provider,{scope:a.__scopeSlider,children:e.jsx(ee.Slot,{scope:a.__scopeSlider,children:e.jsx(k,{"aria-disabled":u,"data-disabled":u?"":void 0,...v,ref:t,onPointerDown:O(v.onPointerDown,()=>{u||(m.current=o)}),min:r,max:n,inverted:i,onSlideStart:u?void 0:N,onSlideMove:u?void 0:M,onSlideEnd:u?void 0:L,onHomeKeyDown:()=>!u&&A(r,0,{commit:!0}),onEndKeyDown:()=>!u&&A(n,o.length-1,{commit:!0}),onStepKeyDown:({event:x,direction:S})=>{if(!u){const F=de.includes(x.key)||x.shiftKey&&ue.includes(x.key)?10:1,_=C.current,T=o[_],P=h*F*S;A(T+P,_,{commit:!0})}}})})})})});ge.displayName=K;var[fe,xe]=he(K,{startEdge:"left",endEdge:"right",size:"width",direction:1}),ea=g.forwardRef((a,t)=>{const{min:s,max:r,dir:n,inverted:h,onSlideStart:d,onSlideMove:u,onSlideEnd:b,onStepKeyDown:w,...R}=a,[l,j]=g.useState(null),i=H(t,k=>j(k)),f=g.useRef(void 0),v=Pe(n),y=v==="ltr",C=y&&!h||!y&&h;function $(k){const o=f.current||l.getBoundingClientRect(),c=[0,o.width],N=te(c,C?[s,r]:[r,s]);return f.current=o,N(k-o.left)}return e.jsx(fe,{scope:a.__scopeSlider,startEdge:C?"left":"right",endEdge:C?"right":"left",direction:C?1:-1,size:"width",children:e.jsx(pe,{dir:v,"data-orientation":"horizontal",...R,ref:i,style:{...R.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:k=>{const o=$(k.clientX);d==null||d(o)},onSlideMove:k=>{const o=$(k.clientX);u==null||u(o)},onSlideEnd:()=>{f.current=void 0,b==null||b()},onStepKeyDown:k=>{const c=me[C?"from-left":"from-right"].includes(k.key);w==null||w({event:k,direction:c?-1:1})}})})}),aa=g.forwardRef((a,t)=>{const{min:s,max:r,inverted:n,onSlideStart:h,onSlideMove:d,onSlideEnd:u,onStepKeyDown:b,...w}=a,R=g.useRef(null),l=H(t,R),j=g.useRef(void 0),i=!n;function f(v){const y=j.current||R.current.getBoundingClientRect(),C=[0,y.height],k=te(C,i?[r,s]:[s,r]);return j.current=y,k(v-y.top)}return e.jsx(fe,{scope:a.__scopeSlider,startEdge:i?"bottom":"top",endEdge:i?"top":"bottom",size:"height",direction:i?1:-1,children:e.jsx(pe,{"data-orientation":"vertical",...w,ref:l,style:{...w.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:v=>{const y=f(v.clientY);h==null||h(y)},onSlideMove:v=>{const y=f(v.clientY);d==null||d(y)},onSlideEnd:()=>{j.current=void 0,u==null||u()},onStepKeyDown:v=>{const C=me[i?"from-bottom":"from-top"].includes(v.key);b==null||b({event:v,direction:C?-1:1})}})})}),pe=g.forwardRef((a,t)=>{const{__scopeSlider:s,onSlideStart:r,onSlideMove:n,onSlideEnd:h,onHomeKeyDown:d,onEndKeyDown:u,onStepKeyDown:b,...w}=a,R=U(K,s);return e.jsx(Q.span,{...w,ref:t,onKeyDown:O(a.onKeyDown,l=>{l.key==="Home"?(d(l),l.preventDefault()):l.key==="End"?(u(l),l.preventDefault()):de.concat(ue).includes(l.key)&&(b(l),l.preventDefault())}),onPointerDown:O(a.onPointerDown,l=>{const j=l.target;j.setPointerCapture(l.pointerId),l.preventDefault(),R.thumbs.has(j)?j.focus():r(l)}),onPointerMove:O(a.onPointerMove,l=>{l.target.hasPointerCapture(l.pointerId)&&n(l)}),onPointerUp:O(a.onPointerUp,l=>{const j=l.target;j.hasPointerCapture(l.pointerId)&&(j.releasePointerCapture(l.pointerId),h(l))})})}),be="SliderTrack",ve=g.forwardRef((a,t)=>{const{__scopeSlider:s,...r}=a,n=U(be,s);return e.jsx(Q.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...r,ref:t})});ve.displayName=be;var ae="SliderRange",je=g.forwardRef((a,t)=>{const{__scopeSlider:s,...r}=a,n=U(ae,s),h=xe(ae,s),d=g.useRef(null),u=H(t,d),b=n.values.length,w=n.values.map(j=>we(j,n.min,n.max)),R=b>1?Math.min(...w):0,l=100-Math.max(...w);return e.jsx(Q.span,{"data-orientation":n.orientation,"data-disabled":n.disabled?"":void 0,...r,ref:u,style:{...a.style,[h.startEdge]:R+"%",[h.endEdge]:l+"%"}})});je.displayName=ae;var se="SliderThumb",ye=g.forwardRef((a,t)=>{const s=Ze(a.__scopeSlider),[r,n]=g.useState(null),h=H(t,u=>n(u)),d=g.useMemo(()=>r?s().findIndex(u=>u.ref.current===r):-1,[s,r]);return e.jsx(sa,{...a,ref:h,index:d})}),sa=g.forwardRef((a,t)=>{const{__scopeSlider:s,index:r,name:n,...h}=a,d=U(se,s),u=xe(se,s),[b,w]=g.useState(null),R=H(t,$=>w($)),l=b?d.form||!!b.closest("form"):!0,j=Re(b),i=d.values[r],f=i===void 0?0:we(i,d.min,d.max),v=na(r,d.values.length),y=j==null?void 0:j[u.size],C=y?ia(y,f,u.direction):0;return g.useEffect(()=>{if(b)return d.thumbs.add(b),()=>{d.thumbs.delete(b)}},[b,d.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[u.startEdge]:`calc(${f}% + ${C}px)`},children:[e.jsx(ee.ItemSlot,{scope:a.__scopeSlider,children:e.jsx(Q.span,{role:"slider","aria-label":a["aria-label"]||v,"aria-valuemin":d.min,"aria-valuenow":i,"aria-valuemax":d.max,"aria-orientation":d.orientation,"data-orientation":d.orientation,"data-disabled":d.disabled?"":void 0,tabIndex:d.disabled?void 0:0,...h,ref:R,style:i===void 0?{display:"none"}:a.style,onFocus:O(a.onFocus,()=>{d.valueIndexToChangeRef.current=r})})}),l&&e.jsx(ta,{name:n??(d.name?d.name+(d.values.length>1?"[]":""):void 0),form:d.form,value:i},r)]})});ye.displayName=se;var ta=a=>{const{value:t,...s}=a,r=g.useRef(null),n=ke(t);return g.useEffect(()=>{const h=r.current,d=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(d,"value").set;if(n!==t&&b){const w=new Event("input",{bubbles:!0});b.call(h,t),h.dispatchEvent(w)}},[n,t]),e.jsx("input",{style:{display:"none"},...s,ref:r,defaultValue:t})};function ra(a=[],t,s){const r=[...a];return r[s]=t,r.sort((n,h)=>n-h)}function we(a,t,s){const h=100/(s-t)*(a-t);return le(h,[0,100])}function na(a,t){return t>2?`Value ${a+1} of ${t}`:t===2?["Minimum","Maximum"][a]:void 0}function oa(a,t){if(a.length===1)return 0;const s=a.map(n=>Math.abs(n-t)),r=Math.min(...s);return s.indexOf(r)}function ia(a,t,s){const r=a/2,h=te([0,50],[0,r]);return(r-h(t)*s)*s}function ca(a){return a.slice(0,-1).map((t,s)=>a[s+1]-t)}function la(a,t){if(t>0){const s=ca(a);return Math.min(...s)>=t}return!0}function te(a,t){return s=>{if(a[0]===a[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(a[1]-a[0]);return t[0]+r*(s-a[0])}}function da(a){return(String(a).split(".")[1]||"").length}function ua(a,t){const s=Math.pow(10,t);return Math.round(a*s)/s}var ma=ge,ha=ve,ga=je,fa=ye;function xa({className:a,defaultValue:t,value:s,min:r=0,max:n=100,...h}){const d=g.useMemo(()=>Array.isArray(s)?s:Array.isArray(t)?t:[r,n],[s,t,r,n]);return e.jsxs(ma,{"data-slot":"slider",defaultValue:t,value:s,min:r,max:n,className:Y("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",a),...h,children:[e.jsx(ha,{"data-slot":"slider-track",className:Y("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(ga,{"data-slot":"slider-range",className:Y("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:d.length},(u,b)=>e.jsx(fa,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},b))]})}const pa=["Fruits & Vegetables","Dairy & Eggs","Meat & Seafood","Bakery","Beverages","Snacks","Frozen Foods","Personal Care","Household","Baby Care"],ba=["Amul","Britannia","Nestle","ITC","Parle","Haldiram's","MTR","Organic India","24 Mantra","Fresho"];function ce({filters:a,onFiltersChange:t,onClearAll:s,categories:r,brands:n}){const h=(r==null?void 0:r.map(i=>i.name))||pa,d=n||ba,[u,b]=g.useState({categories:!0,brands:!0,price:!0,rating:!0,discount:!1,availability:!1}),w=i=>{b(f=>({...f,[i]:!f[i]}))},R=(i,f)=>{const v=f?[...a.categories,i]:a.categories.filter(y=>y!==i);t({...a,categories:v})},l=(i,f)=>{const v=f?[...a.brands,i]:a.brands.filter(y=>y!==i);t({...a,brands:v})},j=a.categories.length+a.brands.length+a.availability.length+(a.rating>0?1:0)+(a.discount>0?1:0)+(a.priceRange[0]>0||a.priceRange[1]<1e4?1:0);return e.jsxs(De,{className:"w-full max-w-sm",children:[e.jsx(Me,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ae,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),"Filters",j>0&&e.jsx(I,{variant:"secondary",className:"ml-2",children:j})]}),j>0&&e.jsx(D,{variant:"ghost",size:"sm",onClick:s,children:"Clear All"})]})}),e.jsxs(Ee,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"search",children:"Search Products"}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(X,{id:"search",placeholder:"Search for products...",value:a.searchQuery,onChange:i=>t({...a,searchQuery:i.target.value}),className:"pl-10"})]})]}),e.jsxs(G,{open:u.categories,onOpenChange:()=>w("categories"),children:[e.jsxs(q,{className:"flex w-full items-center justify-between py-2",children:[e.jsx(B,{className:"text-sm font-medium",children:"Categories"}),e.jsx(Z,{className:`h-4 w-4 transition-transform ${u.categories?"rotate-180":""}`})]}),e.jsx(J,{className:"space-y-3 pt-2",children:e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:h.map(i=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{id:`category-${i}`,checked:a.categories.includes(i),onCheckedChange:f=>R(i,f),className:"h-4 w-4 md:h-5 md:w-5"}),e.jsx(B,{htmlFor:`category-${i}`,className:"text-sm font-normal",children:i})]},i))})})]}),e.jsxs(G,{open:u.price,onOpenChange:()=>w("price"),children:[e.jsxs(q,{className:"flex w-full items-center justify-between py-2",children:[e.jsx(B,{className:"text-sm font-medium",children:"Price Range"}),e.jsx(Z,{className:`h-4 w-4 transition-transform ${u.price?"rotate-180":""}`})]}),e.jsx(J,{className:"space-y-4 pt-2",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(B,{htmlFor:"min-price",className:"text-xs text-muted-foreground",children:"Min"}),e.jsx(X,{id:"min-price",type:"number",placeholder:"0",value:a.priceRange[0]||"",onChange:i=>{const f=Math.max(0,parseInt(i.target.value)||0),v=Math.max(f,a.priceRange[1]);t({...a,priceRange:[f,v]})},className:"h-8 text-sm"})]}),e.jsx("span",{className:"text-muted-foreground mt-4",children:"-"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(B,{htmlFor:"max-price",className:"text-xs text-muted-foreground",children:"Max"}),e.jsx(X,{id:"max-price",type:"number",placeholder:"10000",value:a.priceRange[1]||"",onChange:i=>{const f=Math.min(1e4,parseInt(i.target.value)||1e4),v=Math.min(f,a.priceRange[0]);t({...a,priceRange:[v,f]})},className:"h-8 text-sm"})]})]}),e.jsxs("div",{className:"px-2",children:[e.jsx(xa,{value:a.priceRange,onValueChange:i=>t({...a,priceRange:i}),max:1e4,min:0,step:50,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground mt-2",children:[e.jsxs("span",{children:["₹",a.priceRange[0]]}),e.jsxs("span",{children:["₹",a.priceRange[1]]})]})]})]})})]}),e.jsxs(G,{open:u.brands,onOpenChange:()=>w("brands"),children:[e.jsxs(q,{className:"flex w-full items-center justify-between py-2",children:[e.jsx(B,{className:"text-sm font-medium",children:"Tags"}),e.jsx(Z,{className:`h-4 w-4 transition-transform ${u.brands?"rotate-180":""}`})]}),e.jsx(J,{className:"space-y-3 pt-2",children:e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:d.map(i=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(oe,{id:`brand-${i}`,checked:a.brands.includes(i),onCheckedChange:f=>l(i,f),className:"h-4 w-4 md:h-5 md:w-5"}),e.jsx(B,{htmlFor:`brand-${i}`,className:"text-sm font-normal",children:i})]},i))})})]})]})]})}function va({filters:a,onRemoveFilter:t,onClearAll:s}){return a.categories.length>0||a.brands.length>0||a.availability.length>0||a.rating>0||a.discount>0||a.priceRange[0]>0||a.priceRange[1]<1e4||a.searchQuery.length>0?e.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-4 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Active filters:"}),a.searchQuery&&e.jsxs(I,{variant:"secondary",className:"gap-1",children:['Search: "',a.searchQuery,'"',e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("search",""),children:e.jsx(V,{className:"h-3 w-3"})})]}),a.categories.map(n=>e.jsxs(I,{variant:"secondary",className:"gap-1",children:[n,e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("category",n),children:e.jsx(V,{className:"h-3 w-3"})})]},n)),a.brands.map(n=>e.jsxs(I,{variant:"secondary",className:"gap-1",children:[n,e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("brand",n),children:e.jsx(V,{className:"h-3 w-3"})})]},n)),a.availability.map(n=>e.jsxs(I,{variant:"secondary",className:"gap-1",children:[n,e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("availability",n),children:e.jsx(V,{className:"h-3 w-3"})})]},n)),a.rating>0&&e.jsxs(I,{variant:"secondary",className:"gap-1",children:[a.rating,"+ ⭐",e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("rating",""),children:e.jsx(V,{className:"h-3 w-3"})})]}),a.discount>0&&e.jsxs(I,{variant:"secondary",className:"gap-1",children:[a.discount,"% off",e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("discount",""),children:e.jsx(V,{className:"h-3 w-3"})})]}),(a.priceRange[0]>0||a.priceRange[1]<1e4)&&e.jsxs(I,{variant:"secondary",className:"gap-1",children:["₹",a.priceRange[0]," - ₹",a.priceRange[1],e.jsx(D,{variant:"ghost",size:"sm",className:"h-auto p-0 ml-1",onClick:()=>t("price",""),children:e.jsx(V,{className:"h-3 w-3"})})]}),e.jsx(D,{variant:"outline",size:"sm",onClick:s,className:"ml-2 bg-transparent",children:"Clear All"})]}):null}function ja(){const[a,t]=Le(),[s,r]=g.useState({categories:[],brands:[],priceRange:[0,1e4],rating:0,discount:0,availability:[],searchQuery:""}),[n,h]=g.useState([]),[d,u]=g.useState(!0),[b,w]=g.useState(!1),{currentDepotId:R}=Ke(),{products:l,isLoading:j,error:i}=qe(R);g.useEffect(()=>{const o=a.get("tag");if(console.log("URL tag parameter:",o),o&&l.length>0){const c=new Set;l.forEach(M=>{M.product.tags&&M.product.tags.split(",").map(A=>A.trim()).forEach(A=>c.add(A))});const N=Array.from(c).find(M=>M.toLowerCase()===o.toLowerCase())||o;console.log("Setting brand filter to:",N,"(original:",o,")"),r(M=>{const L={...M,brands:[N]};return console.log("New filters after URL param:",L),L})}else o||r(c=>({...c,brands:[]}))},[a,l]),g.useEffect(()=>{(async()=>{try{u(!0);const c=await Ue.getCategories();h(c)}catch(c){console.error("Failed to fetch categories:",c)}finally{u(!1)}})()},[]);const f=g.useMemo(()=>{const o=new Set;l.forEach(m=>{var L;const N=m.product;N.tags&&N.tags.split(",").map(x=>x.trim()).filter(x=>x.length>0).forEach(x=>{o.add(x),x.toLowerCase().includes("fruit")&&console.log(`Found fruit-related tag: "${x}" in product: ${N.name}`)}),N.isDairyProduct?o.add("Contains Dairy"):o.add("Non-Dairy");const M=N.name.split(" ")[0];M&&M.length>2&&!M.toLowerCase().includes("fresh")&&o.add(M),(L=N.category)!=null&&L.name&&o.add(N.category.name)});const c=Array.from(o).sort();return console.log("Available brands/tags:",c),console.log("Fruits-related brands:",c.filter(m=>m.toLowerCase().includes("fruit"))),c},[l]),v=g.useMemo(()=>{console.log("Filtering products with filters:",s),console.log("Total products to filter:",l.length),s.brands.some(c=>c.toLowerCase()==="fruits")&&(console.log("=== DEBUG: Fruits filter active ==="),console.log("All products and their tags:"),l.forEach((c,m)=>{console.log(`${m+1}. ${c.product.name}: tags="${c.product.tags}"`)}),console.log("Current brand filters:",s.brands),console.log("About to start filtering..."));const o=l.filter(c=>{var L,A;const m=c.product;if(s.categories.length>0&&!s.categories.some(S=>{var p;return((p=m.category)==null?void 0:p.name)===S})||s.brands.length>0&&!s.brands.some(S=>{const p=S.toLowerCase();p==="fruits"&&(console.log(`
=== Checking product: ${m.name} ===`),console.log(`Brand filter: "${S}" (lowercase: "${p}")`));const E=m.name.toLowerCase().includes(p);if(p==="fruits"){const P=["orange","oranges","apple","apples","banana","bananas","mango","mangoes","grape","grapes","fruit"].some(z=>m.name.toLowerCase().includes(z));if(console.log(`Name match: ${E}`),console.log(`Is fruit product (by name): ${P}`),P)return console.log(`✓ Matched as fruit product: ${m.name}`),!0}else p==="fruits"&&console.log(`Name match: ${E}`);let F=!1;if(m.tags){const T=m.tags.split(",").map(P=>P.trim().toLowerCase());(p==="fruits"||S.toLowerCase()==="fruits")&&(console.log(`Product: ${m.name}`),console.log(`Raw tags: "${m.tags}"`),console.log("Parsed tags:",T),console.log(`Looking for brand: "${S}" (lowercase: "${p}")`)),F=T.some(P=>{const z=P===p,re=P.includes(p)||p.includes(P),ne=z||re;return(p==="fruits"||S.toLowerCase()==="fruits")&&(console.log(`  Checking tag: "${P}" against "${p}"`),console.log(`    Exact match (${P} === ${p}): ${z}`),console.log(`    Contains match: ${re}`),console.log(`    Final result: ${ne}`)),ne})}if(p==="dairy"||p==="contains-dairy")return m.isDairyProduct===!0||F||E;if(p==="non-dairy")return m.isDairyProduct===!1||F||E;const _=E||F;return p==="fruits"&&(console.log(`Tag match: ${F}`),console.log(`Final match for ${m.name}: nameMatch=${E}, tagMatch=${F}, finalMatch=${_}`),console.log(`=== End ${m.name} ===
`)),_}))return!1;const N=c.buyOncePrice;if(N<s.priceRange[0]||N>s.priceRange[1]||s.rating>0&&4<s.rating||s.discount>0&&(c.discount?c.discount*100:0)<s.discount)return!1;if(s.availability.length>0){const x=s.availability.includes("In Stock")&&c.inStock,S=s.availability.includes("Same Day Delivery")&&c.inStock,p=s.availability.includes("Express Delivery")&&c.inStock,E=s.availability.includes("Bulk Available");if(!x&&!S&&!p&&!E)return!1}if(s.searchQuery){const x=s.searchQuery.toLowerCase(),S=m.name.toLowerCase().includes(x),p=(L=m.description)==null?void 0:L.toLowerCase().includes(x),E=(A=m.tags)==null?void 0:A.toLowerCase().includes(x);if(!S&&!p&&!E)return!1}return!0});return console.log(`Filtered ${o.length} products out of ${l.length}`),(s.brands.includes("Fruits")||s.brands.includes("fruits"))&&console.log("Products with Fruits filter:",o.map(c=>({name:c.product.name,tags:c.product.tags}))),o},[l,s]),y=o=>{const c=new URLSearchParams(a);o.brands.length>0?c.set("tag",o.brands[0]):c.delete("tag"),t(c)},C=(o,c)=>{let m;switch(o){case"category":m={...s,categories:s.categories.filter(N=>N!==c)};break;case"brand":m={...s,brands:s.brands.filter(N=>N!==c)};break;case"availability":m={...s,availability:s.availability.filter(N=>N!==c)};break;case"rating":m={...s,rating:0};break;case"discount":m={...s,discount:0};break;case"price":m={...s,priceRange:[0,1e4]};break;case"search":m={...s,searchQuery:""};break;default:return}r(m),y(m)},$=()=>{const o={categories:[],brands:[],priceRange:[0,1e4],rating:0,discount:0,availability:[],searchQuery:""};r(o),y(o)},k=(o,c,m)=>{console.log("Adding to cart:",{product:o.product.name,variant:c==null?void 0:c.name,quantity:m||1,price:(c==null?void 0:c.buyOncePrice)||o.buyOncePrice})};return j||d?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Loading products..."})]})}):i?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 mb-4",children:"Failed to load products"}),e.jsx(D,{onClick:()=>window.location.reload(),children:"Retry"})]})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{children:e.jsx(He,{})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"hidden lg:block lg:w-80 flex-shrink-0",children:e.jsx(ce,{filters:s,onFiltersChange:o=>{r(o),y(o)},onClearAll:$,categories:n,brands:f})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"lg:hidden mb-4",children:e.jsxs(Te,{open:b,onOpenChange:w,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:"w-full flex items-center justify-center gap-2 h-12 border-2 hover:bg-accent/50 hover:border-primary/30 transition-all duration-200",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Filters"}),(s.brands.length>0||s.categories.length>0||s.availability.length>0||s.rating>0||s.discount>0||s.searchQuery)&&e.jsx("span",{className:"ml-1 bg-primary text-primary-foreground text-xs px-2 py-0.5 rounded-full",children:[...s.brands,...s.categories,...s.availability,...s.rating>0?["Rating"]:[],...s.discount>0?["Discount"]:[],...s.searchQuery?["Search"]:[]].length})]})}),e.jsxs(_e,{className:"max-h-[90vh] flex flex-col",children:[e.jsx(Be,{className:"text-left border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(W,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(ze,{className:"text-lg font-semibold",children:"Filter Products"}),e.jsxs(Ve,{className:"text-sm text-muted-foreground",children:[v.length," of ",l.length," products"]})]})]}),(s.brands.length>0||s.categories.length>0||s.availability.length>0||s.rating>0||s.discount>0||s.searchQuery)&&e.jsxs(I,{variant:"secondary",className:"text-xs",children:[[...s.brands,...s.categories,...s.availability,...s.rating>0?["Rating"]:[],...s.discount>0?["Discount"]:[],...s.searchQuery?["Search"]:[]].length," active"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"p-4 space-y-6",children:e.jsx(ce,{filters:s,onFiltersChange:o=>{r(o),y(o)},onClearAll:$,categories:n,brands:f})})}),e.jsx(Oe,{className:"border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 p-4",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[(s.brands.length>0||s.categories.length>0||s.availability.length>0||s.rating>0||s.discount>0||s.searchQuery)&&e.jsx(D,{variant:"ghost",size:"sm",onClick:$,className:"self-start text-muted-foreground hover:text-foreground",children:"Clear all filters"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(ie,{asChild:!0,children:e.jsx(D,{variant:"outline",className:"flex-1",size:"lg",children:"Cancel"})}),e.jsx(ie,{asChild:!0,children:e.jsxs(D,{className:"flex-1",size:"lg",onClick:()=>w(!1),children:["Show ",v.length," Products"]})})]})]})})]})]})}),e.jsx(va,{filters:s,onRemoveFilter:C,onClearAll:$}),e.jsx("div",{className:"flex items-center justify-between mb-6 mt-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Products (",v.length,")"]}),a.get("tag")&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Filtered by tag: ",e.jsx("span",{className:"font-medium",children:a.get("tag")})]})]})}),e.jsx(Ge,{products:v,onAddToCart:k,isLoading:j}),v.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"No products found matching your filters."}),e.jsx(D,{variant:"outline",onClick:$,className:"mt-4 bg-transparent",children:"Clear All Filters"})]})]})]})}),e.jsx(Qe,{})]})}const Ra=()=>e.jsx(Ye,{children:e.jsx(Xe,{children:e.jsx(ja,{})})});export{Ra as default};
